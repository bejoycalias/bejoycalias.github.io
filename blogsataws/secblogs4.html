<!DOCTYPE html>
<html lang="en">
  <head>
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-593498H');</script>
<!-- End Google Tag Manager -->

    <meta charset="utf-8">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">

    <meta name="msapplication-config" content="/microsoft-tile.xml" />
    <meta name="theme-color" content="#ffffff">

    <meta property="og:url" content="https://bejoycalias.github.io/blogsataws/secblogs1.html" />
    <meta property="og:site_name" content="Bejoy's TechNotes"/>
    <meta property="og:title" content="Bejoy's TechNotes - Security Blogs @ AWS" />
    <meta property="og:image" content="https://bejoycalias.github.io/assets/images/og-image.png"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="1200"/>
    <meta property="og:description" content="" />

    <title>Bejoy's TechNotes - Security Blogs @ AWS</title>
    <link href="../assets/stylesheets/application-832aa42c.css" rel="stylesheet" />

    <!--[if lt IE 9]>
      <script src="../assets/javascripts/ie-compat-c141a02d.js"></script>
    <![endif]-->
    <script src="../assets/javascripts/application-ff53d307.js"></script>

    <!-- Typekit script to import Klavika font -->
    <script src="https://use.typekit.net/wxf7mfi.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-100043608-1', 'auto');
  ga('send', 'pageview');

</script>

    
  </head>

  <body id="uh-oh-" class="layout-inner page-uh-oh-">
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-593498H"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


    <div id="header" class="navigation navbar-static-top hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <div class="navbar-header">
              <div class="navbar-brand">
                <a href="/">
                  <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="135.000000pt" height="50" viewbox="0 0 135.000000 45.000000" preserveaspectratio="xMidYMid meet" class="logo">

<g transform="translate(0.000000,45.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
<path class="text" fill="#000000" d="M527 384 c-4 -4 -7 -18 -7 -31 0 -21 4 -24 28 -21 21 2 27 8 27 28 0
18 -6 26 -20 28 -12 2 -24 0 -28 -4z"></path>
<path class="text" fill="#000000" d="M1080 335 c0 -48 2 -55 20 -55 18 0 20 7 20 55 0 48 -2 55 -20 55
-18 0 -20 -7 -20 -55z"></path>
<path class="text" fill="#000000" d="M54 357 c-2 -7 -3 -69 -2 -138 l3 -124 65 -3 c90 -3 130 20 130 77 0
29 -6 44 -20 54 -20 14 -20 15 -3 45 14 25 15 34 5 56 -6 15 -23 31 -38 36
-38 15 -134 13 -140 -3z m110 -33 c19 -7 21 -45 4 -62 -7 -7 -22 -12 -35 -12
-20 0 -23 5 -23 40 0 41 13 50 54 34z m20 -130 c19 -18 19 -20 6 -45 -8 -13
-21 -19 -45 -19 -34 0 -35 1 -35 40 0 38 2 40 29 40 16 0 37 -7 45 -16z"></path>
<path class="text" fill="#000000" d="M319 271 c-23 -24 -29 -38 -29 -74 0 -25 3 -53 6 -62 20 -50 164 -64
164 -15 0 15 -7 17 -45 12 -46 -5 -75 8 -75 34 0 11 16 14 65 14 l65 0 0 35
c0 80 -92 114 -151 56z m99 -33 c3 -15 -4 -18 -37 -18 -43 0 -50 7 -29 28 18
18 62 11 66 -10z"></path>
<path class="text" fill="#000000" d="M520 184 c0 -107 -1 -116 -20 -121 -11 -3 -20 -12 -20 -19 0 -21 76
-19 84 2 3 9 6 69 6 135 l0 119 -25 0 -25 0 0 -116z"></path>
<path class="text" fill="#000000" d="M649 271 c-24 -25 -29 -37 -29 -78 1 -70 34 -103 105 -103 55 0 95
44 95 103 0 60 -7 75 -41 92 -47 25 -96 19 -130 -14z m111 -30 c25 -48 2 -111
-40 -111 -45 0 -69 80 -34 114 21 22 61 20 74 -3z"></path>
<path class="text" fill="#000000" d="M850 287 c0 -8 16 -57 36 -110 28 -76 33 -100 25 -116 -16 -28 -14
-31 18 -31 27 0 29 4 70 123 23 67 41 128 41 135 0 6 -11 12 -24 12 -21 0 -26
-8 -41 -65 -10 -36 -21 -68 -25 -70 -3 -2 -16 27 -29 66 -19 60 -25 69 -47 69
-13 0 -24 -6 -24 -13z"></path>
<path class="text" fill="#000000" d="M1192 284 c-17 -12 -22 -24 -20 -47 2 -26 10 -36 45 -52 49 -23 59
-55 17 -55 -14 0 -34 5 -45 10 -16 9 -19 7 -19 -13 0 -17 7 -27 23 -31 69 -18
117 6 117 60 0 32 -4 37 -45 55 -60 26 -62 54 -4 46 37 -5 40 -3 37 16 -2 18
-11 23 -43 25 -25 2 -49 -3 -63 -14z"></path>
</g>
</svg>

                </a>
              </div>
              <button class="navbar-toggle" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="buttons hidden-xs">
              <nav class="navigation-links" role="navigation">
                <ul class="main-links nav navbar-nav navbar-right">
                  <li><a href="../aws.html">AWS</a></li>
                  <li><a href="../linux.html">Linux</a></li>
                  <li><a href="../docker.html">Docker</a></li>
                  <li><a href="../ibmpower.html">IBM Power</a></li>
                  <li><a href="blogsataws1.html">Blogs@AWS (Kindle Friendly)</a></li>
                </ul>
              </nav>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sidebar-overlay"></div>

<aside class="sidebar" role="navigation">
  <div class="sidebar-header">
    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="135.000000pt" height="42" viewbox="0 0 135.000000 45.000000" preserveaspectratio="xMidYMid meet">

<g transform="translate(0.000000,45.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
<path class="text" fill="#000000" d="M527 384 c-4 -4 -7 -18 -7 -31 0 -21 4 -24 28 -21 21 2 27 8 27 28 0
18 -6 26 -20 28 -12 2 -24 0 -28 -4z"></path>
<path class="text" fill="#000000" d="M1080 335 c0 -48 2 -55 20 -55 18 0 20 7 20 55 0 48 -2 55 -20 55
-18 0 -20 -7 -20 -55z"></path>
<path class="text" fill="#000000" d="M54 357 c-2 -7 -3 -69 -2 -138 l3 -124 65 -3 c90 -3 130 20 130 77 0
29 -6 44 -20 54 -20 14 -20 15 -3 45 14 25 15 34 5 56 -6 15 -23 31 -38 36
-38 15 -134 13 -140 -3z m110 -33 c19 -7 21 -45 4 -62 -7 -7 -22 -12 -35 -12
-20 0 -23 5 -23 40 0 41 13 50 54 34z m20 -130 c19 -18 19 -20 6 -45 -8 -13
-21 -19 -45 -19 -34 0 -35 1 -35 40 0 38 2 40 29 40 16 0 37 -7 45 -16z"></path>
<path class="text" fill="#000000" d="M319 271 c-23 -24 -29 -38 -29 -74 0 -25 3 -53 6 -62 20 -50 164 -64
164 -15 0 15 -7 17 -45 12 -46 -5 -75 8 -75 34 0 11 16 14 65 14 l65 0 0 35
c0 80 -92 114 -151 56z m99 -33 c3 -15 -4 -18 -37 -18 -43 0 -50 7 -29 28 18
18 62 11 66 -10z"></path>
<path class="text" fill="#000000" d="M520 184 c0 -107 -1 -116 -20 -121 -11 -3 -20 -12 -20 -19 0 -21 76
-19 84 2 3 9 6 69 6 135 l0 119 -25 0 -25 0 0 -116z"></path>
<path class="text" fill="#000000" d="M649 271 c-24 -25 -29 -37 -29 -78 1 -70 34 -103 105 -103 55 0 95
44 95 103 0 60 -7 75 -41 92 -47 25 -96 19 -130 -14z m111 -30 c25 -48 2 -111
-40 -111 -45 0 -69 80 -34 114 21 22 61 20 74 -3z"></path>
<path class="text" fill="#000000" d="M850 287 c0 -8 16 -57 36 -110 28 -76 33 -100 25 -116 -16 -28 -14
-31 18 -31 27 0 29 4 70 123 23 67 41 128 41 135 0 6 -11 12 -24 12 -21 0 -26
-8 -41 -65 -10 -36 -21 -68 -25 -70 -3 -2 -16 27 -29 66 -19 60 -25 69 -47 69
-13 0 -24 -6 -24 -13z"></path>
<path class="text" fill="#000000" d="M1192 284 c-17 -12 -22 -24 -20 -47 2 -26 10 -36 45 -52 49 -23 59
-55 17 -55 -14 0 -34 5 -45 10 -16 9 -19 7 -19 -13 0 -17 7 -27 23 -31 69 -18
117 6 117 60 0 32 -4 37 -45 55 -60 26 -62 54 -4 46 37 -5 40 -3 37 16 -2 18
-11 23 -43 25 -25 2 -49 -3 -63 -14z"></path>
</g>
</svg>

  </div>

  <ul class="nav sidebar-nav">
    <li><a href="../aws.html">AWS</a></li>
    <li><a href="../linux.html">Linux</a></li>
    <li><a href="../docker.html">Docker</a></li>
    <li><a href="../ibmpower.html">IBM Power</a></li>
    <li><a href="blogsataws1.html">Blogs@AWS (Kindle Friendly)</a></li>
  </ul>
</aside>


    <div class="container">
  <div class="row">
    <div id="docs-sidebar" class="col-sm-3 col-md-3 col-xs-12 hidden-print" role="complementary">
      <ul class="nav docs-sidenav">
      <li><a href="blogsataws1.html">Blogs @ AWS</a></li>
      <li><a href="whatsnew1.html">What's New @ AWS</a></li>
      <li class="active"><a href="secblogs1.html">Security Blogs @ AWS</a></li>
      <li><a href="computeblogs1.html">Compute Blogs @ AWS</a></li>
      <li><a href="apnblogs1.html">APN Blogs @ AWS</a></li>
      <li><a href="devopsblogs1.html">DevOps Blogs @ AWS</a></li>
      <li><a href="mgmtblogs1.html">Management Tools Blogs @ AWS</a></li>

    </ul>
    </div>

    <div id="inner" class="col-sm-9 col-md-9 col-xs-12" role="main">
<p></p>
<p><i>Contents of this page is copied directly from AWS blog sites to make it Kindle friendly. Some styles & sections from these pages are removed to render this properly in 'Article Mode' of Kindle e-Reader browser. All the contents of this page is property of AWS.</i></p>
<p><a href="secblogs1.html">Page 1</a>|<a href="secblogs2.html">Page 2</a>|<a href="secblogs3.html">Page 3</a>|<a href="secblogs4.html">Page 4</a</p>
<br>
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b><a href="https://aws.amazon.com/blogs/security/the-first-aws-regional-financial-services-guide-focuses-on-singapore/" property="url" rel="bookmark"><span property="name headline">The First AWS Regional Financial Services Guide Focuses on Singapore</span></a></b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Jodi Scrofani</span></span> | on 
<time property="datePublished" datetime="2017-08-03T16:00:05+00:00">03 AUG 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/compliance/" title="View all posts in Compliance*"><span property="articleSection">Compliance*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/the-first-aws-regional-financial-services-guide-focuses-on-singapore/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4369" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4369&amp;disqus_title=The+First+AWS+Regional+Financial+Services+Guide+Focuses+on+Singapore&amp;disqus_url=https://aws.amazon.com/blogs/security/the-first-aws-regional-financial-services-guide-focuses-on-singapore/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4369');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p style="text-align: center"><img class="alignnone wp-image-4389 size-full" title="Financial Services image" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/27/financial-services_banking_payments_large.png" alt="Financial Services image" width="601" height="301" /></p> 
<p>To help Financial Services clients address Singapore’s regulations on financial institutions in a <a href="https://aws.amazon.com/compliance/shared-responsibility-model/" target="_blank" rel="noopener noreferrer">shared responsibility environment</a>, AWS has published the&nbsp;<a href="https://d0.awsstatic.com/whitepapers/compliance/Financial_Services_Regulations_Guidelines_in_Singapore.pdf" target="_blank" rel="noopener noreferrer">AWS User Guide to Financial Services Regulations and Guidelines in Singapore</a>. This first-ever AWS Financial Services guide is the culmination of the work AWS has done in the last year to help customers navigate the Monetary Authority of Singapore’s 2016 updated guidelines about cloud services.</p> 
<p>This new guide examines Singaporean requirements and guidelines, providing information that will help you conduct due diligence on AWS with regard to IT security and risk management. The guide also shares leading practices to empower you to develop your own governance programs by using AWS.</p> 
<p>The guide focuses on three top considerations for financial institutions operating in Singapore:</p> 
<ul> 
<li><strong>Outsourcing guidelines</strong> – Conduct a self-assessment of AWS services and align your governance requirements within a shared responsibility model.</li> 
<li><strong>Technology risk management</strong> – Take a deeper look at where shared responsibility exists for technology implementation and perform a self-assessment of AWS service responsibilities.</li> 
<li><strong>Cloud computing implementation</strong> – Assess additional responsibilities to ensure security and compliance with local guidelines.</li> 
</ul> 
<p>We will release additional AWS Financial Services resource guides this year to help you understand the requirements in other markets around the globe. These guides will be posted on the <a href="https://aws.amazon.com/compliance/resources/" target="_blank" rel="noopener noreferrer">AWS Compliance Resources</a> page.</p> 
<p>If you have questions or comments about this new guide, submit them in the “Comments” section below.</p> 
<p>– Jodi</p> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b><a href="https://aws.amazon.com/blogs/security/announcing-the-new-customer-compliance-center/" property="url" rel="bookmark"><span property="name headline">Announcing the New AWS Customer Compliance Center</span></a></b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Chad Woolf</span></span> | on 
<time property="datePublished" datetime="2017-08-02T18:57:20+00:00">02 AUG 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/compliance/" title="View all posts in Compliance*"><span property="articleSection">Compliance*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/announcing-the-new-customer-compliance-center/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4544" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4544&amp;disqus_title=Announcing+the+New+AWS+Customer+Compliance+Center&amp;disqus_url=https://aws.amazon.com/blogs/security/announcing-the-new-customer-compliance-center/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4544');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p><img class="size-full wp-image-4569 aligncenter" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/02/AWSComplianceLogoBlue.png" alt="" width="190" height="150" /></p> 
<p>AWS has the longest running, most effective, and most customer-obsessed compliance program in the cloud market. We have always centered our program around customers, obtaining the certifications needed to provide our customers with the proper level of validated transparency in order to enable them to certify their own AWS workloads [<a href="https://d0.awsstatic.com/whitepapers/compliance/AWS_Certifications_Programs_Reports_Third-Party_Attestations.pdf">download .pdf of AWS certifications</a>]. We also offer a rich suite of embedded compliance tooling, enabling customers and partners to more effectively manage security controls and in turn provide evidence of effective control operation to their auditors. Along with our customers and partners, we have the largest, most diverse, and most comprehensive compliance footprint in the industry.</p> 
<p>Enabling customers is a core part of the AWS DNA. Today, in the spirit of that pedigree, I’m happy to announce we’ve launched a new<a href="https://aws.amazon.com/compliance/customer-center/"> AWS Customer Compliance Center</a>. This center is focused on the security and compliance of our customers on AWS. You can learn from other customer experiences and discover how your peers have solved the compliance, governance, and audit challenges present in today’s regulatory environment. You can also access our industry-first <a href="https://aws.amazon.com/compliance/auditor-learning-path/">cloud Auditor Learning Path</a> via the&nbsp;customer center. These online university learning resources are logical learning paths, specifically designed for security, compliance and audit professionals, allowing you to build on the IT skills you have to move your environment to the next generation of audit and security assurance. As we engage with our security and compliance customer colleagues on this topic, we will continue to update and improve upon the existing resource and publish new enablers in the coming months.</p> 
<p>We are excited to continue to work with our customers on moving from the old-guard manual audit world to the new cloud-enabled, automated, “secure and compliant by default” model we’ve been leading over the past few years.</p> 
<p>– Chad Woolf, AWS Security &amp; Compliance</p> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">Newly Updated: Example AWS IAM Policies for You to Use and Customize</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Deren Smith</span></span> | on 
<time property="datePublished" datetime="2017-08-02T08:56:10+00:00">02 AUG 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/aws-identity-and-access-management-iam/" title="View all posts in AWS Identity and Access Management (IAM)*"><span property="articleSection">AWS Identity and Access Management (IAM)*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/newly-updated-example-policies-for-you-to-use-and-customize/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4089" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4089&amp;disqus_title=Newly+Updated%3A+Example+AWS+IAM+Policies+for+You+to+Use+and+Customize&amp;disqus_url=https://aws.amazon.com/blogs/security/newly-updated-example-policies-for-you-to-use-and-customize/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4089');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p>To help you grant access to specific resources and conditions, the&nbsp;<a href="https://docs.aws.amazon.com/console/iam/example-policies" target="_blank" rel="noopener noreferrer">Example Policies</a>&nbsp;page in the AWS Identity and Access Management (IAM) documentation now includes more than thirty policies for you to use or customize to meet your permissions requirements. The AWS Support team developed these policies from their experiences working with AWS customers over the years. The example policies cover common permissions use cases you might encounter across services such as <a href="https://aws.amazon.com/dynamodb/" target="_blank" rel="noopener noreferrer">Amazon DynamoDB</a>, <a href="https://aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">Amazon EC2</a>, <a href="http://aws.amazon.com/elasticbeanstalk" target="_blank" rel="noopener noreferrer">AWS Elastic Beanstalk</a>, <a href="http://aws.amazon.com/rds/" target="_blank" rel="noopener noreferrer">Amazon RDS</a>, <a href="https://aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3</a>, and IAM.</p> 
<p>In this blog post, I introduce the updated Example Policies page and explain how to use and customize these policies for your needs.</p> 
<h3>The new Example Policies page</h3> 
<p>The Example Policies page in the IAM User Guide now provides an overview of the example policies and includes a link to view each policy on a separate page. Note that each of these policies has been reviewed and approved by AWS Support. If you would like to submit a policy that you have found to be particularly useful, post it on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=76" target="_blank" rel="noopener noreferrer">IAM forum</a>.<span id="more-4089"></span></p> 
<p>To give you an idea of the policies we have included on this page, the following are a few of the EC2 policies on the page:</p> 
<ul> 
<li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_ec2_ebs-owner.html" target="_blank" rel="noopener noreferrer">Attach or Detach Amazon EBS Volumes to EC2 Instances Based on Tags</a></li> 
<li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_ec2_region.html" target="_blank" rel="noopener noreferrer">Allows Full EC2 Access Within a Specific Region, Programmatically and in the Console</a></li> 
<li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_ec2_instances-subnet.html" target="_blank" rel="noopener noreferrer">Allows Launching EC2 Instances in a Specific Subnet, Programmatically and in the Console</a></li> 
</ul> 
<p>To see the full list of available policies, see the <a href="https://docs.aws.amazon.com/console/iam/example-policies" target="_blank" rel="noopener noreferrer">Example Polices</a> page.</p> 
<p>In the following section, I demonstrate how to use a policy from the Example Policies page and customize it for your needs.</p> 
<h3>How to customize an example policy for your needs</h3> 
<p>Suppose you want to allow an IAM user, <span style="font-family: courier">Bob</span>, to start and stop EC2 instances with a specific&nbsp;<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html" target="_blank" rel="noopener noreferrer">resource tag</a>. After looking through the Example Policies page, you see the policy, <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_examples_ec2_tag-owner.html" target="_blank" rel="noopener noreferrer">Allows Starting or Stopping EC2 Instances a User Has Tagged, Programmatically and in the Console</a>.</p> 
<p>To apply this policy to your specific use case:</p> 
<ol> 
<li>Navigate to the <strong>Policies</strong> section of the <a href="https://console.aws.amazon.com/iam/home" target="_blank" rel="noopener noreferrer">IAM console</a>.</li> 
<li>Choose <strong>Create policy</strong>.<br /> <img class="alignnone wp-image-4092 size-full" title="Screenshot of choosing &quot;Create policy&quot;" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/06/29/createpolicy-DS-July2017.png" alt="Screenshot of choosing &quot;Create policy&quot;" width="384" height="262" /><strong><br /> </strong></li> 
<li>Choose the <strong>Select</strong> button next to <strong>Create Your Own Policy</strong>. You will see an empty policy document with boxes for <strong>Policy Name</strong>, <strong>Description</strong>, and <strong>Policy Document</strong>, as shown in the following screenshot.<br /> <img class="alignnone wp-image-4184 size-full" title="Screenshot of an empty policy document" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/07/reviewpolicy-DS-July2017-c.png" alt="" width="762" height="429" /></li> 
<li>Type a name for the policy, copy the policy from the&nbsp;<a href="https://docs.aws.amazon.com/console/iam/example-policies" target="_blank" rel="noopener noreferrer">Example Policies</a>&nbsp;page, and paste the policy in the <strong>Policy Document</strong> box. In this example, I use “start-stop-instances-for-owner-tag” as the policy name and “Allows users to start or stop instances if the instance tag Owner has the value of their user name” as the description.</li> 
<li>Update the <strong>placeholder text</strong> in the policy (see the full policy that follows this step). For example, replace <strong>&lt;REGION&gt;</strong> with a region from&nbsp;<a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region" target="_blank" rel="noopener noreferrer">AWS Regions and Endpoints</a> and <strong>&lt;ACCOUNTNUMBER&gt; </strong>with your <a href="http://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html#FindingYourAccountIdentifiers" target="_blank" rel="noopener noreferrer">12-digit account number</a>. The IAM policy variable, <span style="font-family: courier">${aws:username}</span>, is a dynamic property in the policy that automatically applies to the user to which it is attached. For example, when the policy is attached to <span style="font-family: courier">Bob</span>, the policy replaces <span style="font-family: courier">${aws:username}</span> with <span style="font-family: courier">Bob</span>. If you do not want to use the key value pair of <span style="font-family: courier">Owner</span> and <span style="font-family: courier">${aws:username}</span>, you can edit the policy to include your desired key value pair. For example, if you want to use the key value pair, <span style="font-family: courier">CostCenter:1234</span>, you can modify <span style="font-family: courier">“ec2:ResourceTag/Owner”: “${aws:username}”</span> to <span style="font-family: courier">“ec2:ResourceTag/CostCenter”: “1234”</span>. 
<pre><code class="lang-text">{
&nbsp;&nbsp;&nbsp; &quot;Version&quot;: &quot;2012-10-17&quot;,
&nbsp;&nbsp;&nbsp; &quot;Statement&quot;: [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Effect&quot;: &quot;Allow&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Action&quot;: [
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;ec2:StartInstances&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;ec2:StopInstances&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ],
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Resource&quot;: &quot;arn:aws:ec2:<strong>&lt;REGION&gt;</strong>:<strong>&lt;ACCOUNTNUMBER&gt;</strong>:instance/*&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Condition&quot;: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &quot;StringEquals&quot;: {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;ec2:ResourceTag/Owner&quot;: &quot;${aws:username}&quot;
&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; },
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Effect&quot;: &quot;Allow&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Action&quot;: &quot;ec2:DescribeInstances&quot;,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot;Resource&quot;: &quot;*&quot;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }
&nbsp;&nbsp;&nbsp; ]
}</code></pre> 
<li>After you have edited the policy, choose <strong>Create policy</strong>.</li> 
</ol> 
<p>You have created a policy that allows an IAM user to stop and start EC2 instances in your account, as long as these instances have the correct resource tag and the policy is attached to your IAM users. You also can <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-using.html#attach-managed-policy-console" target="_blank" rel="noopener noreferrer">attach this policy</a> to an IAM group and apply the policy to users by adding them to that group.</p> 
<h3>Summary</h3> 
<p>We updated the <a href="https://docs.aws.amazon.com/console/iam/example-policies" target="_blank" rel="noopener noreferrer">Example Policies</a> page in the IAM User Guide so that you have a central location where you can find examples of the most commonly requested and used IAM policies. In addition to these example policies, we recommend that you review the list of <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#aws-managed-policies" target="_blank" rel="noopener noreferrer">AWS managed policies</a>, including the <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html" target="_blank" rel="noopener noreferrer">AWS managed policies for job functions</a>. You can choose these predefined policies from the IAM console and associate them with your IAM users, groups, and roles.</p> 
<p>We will add more IAM policies to the Example Policies page over time. If you have a useful policy you would like to share with others, post it on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=76" target="_blank" rel="noopener noreferrer">IAM forum</a>. If you have comments about this post, submit them in the “Comments” section below.</p> 
<p>– Deren</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/amazon-ec2/" rel="tag">Amazon EC2</a>, <a href="https://aws.amazon.com/blogs/security/tag/amazon-s3/" rel="tag">Amazon S3</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-iam/" rel="tag">AWS IAM</a>, <a href="https://aws.amazon.com/blogs/security/tag/example-policies/" rel="tag">example policies</a>, <a href="https://aws.amazon.com/blogs/security/tag/permissions/" rel="tag">Permissions</a>, <a href="https://aws.amazon.com/blogs/security/tag/policies/" rel="tag">Policies</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4089');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">How to Monitor and Visualize Failed SSH Access Attempts to Amazon EC2 Linux Instances</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Assaf Namer</span></span> | on 
<time property="datePublished" datetime="2017-08-02T05:51:56+00:00">02 AUG 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/compute/amazon-ec2/" title="View all posts in Amazon EC2*"><span property="articleSection">Amazon EC2*</span></a>, <a href="https://aws.amazon.com/blogs/security/category/how-to/" title="View all posts in How-To*"><span property="articleSection">How-To*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/how-to-monitor-and-visualize-failed-ssh-access-attempts-to-amazon-ec2-linux-instances/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4411" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4411&amp;disqus_title=How+to+Monitor+and+Visualize+Failed+SSH+Access+Attempts+to+Amazon+EC2+Linux+Instances&amp;disqus_url=https://aws.amazon.com/blogs/security/how-to-monitor-and-visualize-failed-ssh-access-attempts-to-amazon-ec2-linux-instances/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4411');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p>As part of the <a href="https://aws.amazon.com/compliance/shared-responsibility-model/" target="_blank" rel="noopener noreferrer">AWS Shared Responsibility Model</a>, you are responsible for monitoring and managing your resources at the operating system and application level. When you monitor your application servers, for example, you can measure, visualize, react to, and improve the security of those servers. You probably already do this on premises or in other environments,&nbsp;and you can adapt your existing processes, tools, and methodologies for use in the AWS Cloud. For more details about best practices for monitoring your AWS resources, see the “Manage Security Monitoring, Alerting, Audit Trail, and Incident Response” section in the <a href="https://d0.awsstatic.com/whitepapers/Security/AWS_Security_Best_Practices.pdf" target="_blank" rel="noopener noreferrer">AWS Security Best Practices whitepaper</a>.</p> 
<p>This blog post focuses on how to log and create alarms on invalid <a href="https://en.wikipedia.org/wiki/Secure_Shell" target="_blank" rel="noopener noreferrer">Secure Shell</a> (SSH) access attempts. Implementing live monitoring and session recording facilitates the identification of unauthorized activity and can help confirm that remote users access only those systems they are authorized to use. With SSH log information in hand (such as invalid access type, bad private keys, and remote IP addresses), you can take proactive actions to protect your servers. For example, you can use an <a href="https://aws.amazon.com/lambda/" target="_blank" rel="noopener noreferrer">AWS Lambda</a> function to adjust your server’s security rules when an alarm is triggered that indicates an invalid SSH access attempt.</p> 
<p>In this post, I demonstrate how to use <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html" target="_blank" rel="noopener noreferrer">Amazon CloudWatch Logs</a> to monitor SSH access to your application servers (<a href="https://aws.amazon.com/ec2/" target="_blank" rel="noopener noreferrer">Amazon EC2</a> Linux instances) so that you can monitor rejected SSH connection requests and take action. I also show how to configure CloudWatch Logs to send SSH access logs from application servers that reside in a public subnet. Last, I demonstrate how to visualize how many attempts are made to SSH into your application servers with bad private keys and invalid user names. Using these techniques and tools can help you improve the security of your application servers.</p> 
<p><span id="more-4411"></span></p> 
<h3>AWS services and terminology I use in this post</h3> 
<p>In this post, I use the following AWS services and terminology:</p> 
<ul> 
<li><a href="https://aws.amazon.com/cloudwatch/" target="_blank" rel="noopener noreferrer">Amazon CloudWatch</a> – A&nbsp;monitoring service for the resources and applications you run on the AWS Cloud. You can use CloudWatch to collect and track metrics, collect and monitor log files, set alarms, and automatically react to changes in your AWS resources.</li> 
<li><a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/aws-namespaces.html">CloudWatch namespaces</a> – Containers for metrics. Metrics in different namespaces are isolated from each other so that metrics from different applications are not mistakenly aggregated into the same statistics. You also can create custom metrics for which you must specify namespaces as containers.</li> 
<li>CloudWatch Logs&nbsp;– A feature of CloudWatch that allows you to monitor, store, and access your log files from EC2 instances, <a href="https://aws.amazon.com/cloudtrail/" target="_blank" rel="noopener noreferrer">AWS CloudTrail</a>, and other sources. Additionally, you can use CloudWatch Logs to monitor applications and systems by using log data and create alarms. For example, you can choose to search for a phrase in logs and then create an alarm if the phrase you are looking for is found in the log more than 5 times in the last 10 minutes. You can then take action on these alarms, if necessary.</li> 
<li><a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-logs-logstream.html" target="_blank" rel="noopener noreferrer">Log stream</a> – A log stream represents the sequence of events coming from an application instance or resource that you are monitoring. In this post, I use the EC2 instance ID as the log stream identifier so that I can easily map log entries to the instances that produced the log entries</li> 
<li><a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-logs-loggroup.html" target="_blank" rel="noopener noreferrer">Log group</a> – In CloudWatch Logs, a group of log streams that share the same retention time, monitoring, and access control settings. Each log stream must belong to one log</li> 
<li>Metric – A specific term or value that you can monitor and extract from log events.</li> 
<li><a href="http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-logs-metricfilter.html" target="_blank" rel="noopener noreferrer">Metric filter</a> – A metric filter describes how Amazon CloudWatch Logs extracts information from logs and transforms it into CloudWatch metrics.&nbsp;It defines the terms and patterns to look for in log data as the data is sent to CloudWatch Logs. Metric filters are assigned to log groups, and all metric filters assigned to a given log group are applied to their log stream—see the following diagram for more details.</li> 
<li>SSH logs – Reside on EC2 instances and capture all SSH activities. The logs include successful attempts as well as unsuccessful attempts. Debian Linux SSH logs reside in <span style="font-family: courier">/var/log/auth.log</span>, and stock CentOS SSH logs are written to <span style="font-family: courier">/var/log/secure</span>. This blog post uses an <a href="https://aws&lt;/span&gt;.amazon.com/amazon-linux-ami/" target="_blank" rel="noopener noreferrer">Amazon Linux AMI</a>, which also logs SSH sessions to <span style="font-family: courier">/var/log/secure</span>.</li> 
<li><a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS Identity and Access Management (IAM)</a> – IAM enables you to securely control access to AWS services and resources for your users. In the solution in this post, you create an IAM policy and configure an EC2 instance that <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html" target="_blank" rel="noopener noreferrer">assumes a role</a>. The IAM policy allows the EC2 instance to create log events and save them in an <a href="https://aws.amazon.com/s3/" target="_blank" rel="noopener noreferrer">Amazon S3</a> bucket (in other words, CloudWatch Logs log files are saved in the S3 bucket).</li> 
<li><a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards.html" target="_blank" rel="noopener noreferrer">CloudWatch dashboards</a> – Amazon CloudWatch dashboards are customizable home pages in the CloudWatch console that you can use to monitor your resources in a single view, even those resources that are spread across different regions. You can use CloudWatch dashboards to create customized views of the metrics and alarms for your AWS resources.</li> 
</ul> 
<h3>Architectural overview</h3> 
<p>The following diagram depicts the services and flow of information between the different AWS services used in this post’s solution.</p> 
<p><img class="alignnone wp-image-4523 size-full" title="Solution diagram" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/01/AssafDiagram-AugustFINAL.png" alt="" width="937" height="588" /></p> 
<p>Here is how the process works, as illustrated and numbered in the preceding diagram:</p> 
<ol> 
<li>A CloudWatch Logs agent runs on each EC2 instance. The agents are configured to send SSH logs from the EC2 instance to a log stream identified by an instance ID.</li> 
<li>Log streams are aggregated into a log group. As a result, one log group contains all the logs you want to analyze from one or more instances.</li> 
<li>You apply metric filters to a log group in order to search for specific keywords. When the metric filter finds specific keywords, the filter counts the occurrences of the keywords in a time-based sliding window. If the occurrence of a keyword exceeds the CloudWatch alarm threshold, an alarm is triggered.</li> 
<li>An IAM policy defines a role that gives the EC2 servers permission to create logs in a log group and send log events (new log entries) from EC2 to log groups. This role is then assumed by the application servers.</li> 
<li>CloudWatch alarms notify users when a specified threshold has been crossed. For example, you can set an alarm to trigger when more than 2 failed SSH connections happen in a 5-minute period.</li> 
<li>The CloudWatch dashboard is used to visualize data and alarms from the monitoring process.</li> 
</ol> 
<b>Deploy and test the solution</b> 
<h3>1. &nbsp;Deploy the solution by using CloudFormation</h3> 
<p>Now that I have explained how the solution works, I will show how to use <a href="https://aws.amazon.com/cloudformation/" target="_blank" rel="noopener noreferrer">AWS CloudFormation</a> to create a stack with the desired solution configuration. CloudFormation allows you to create a stack of resources in your AWS account.</p> 
<ol> 
<li>Sign in to the <a href="https://console.aws.amazon.com/console/home" target="_blank" rel="noopener noreferrer">AWS Management Console</a>, choose <strong>CloudFormation</strong>, choose <strong>Create Stack</strong>, choose&nbsp;<strong>Specify an Amazon S3 template URL </strong>and paste the following link in the box:<span style="font-family: courier"> https://s3.amazonaws.com/awsiammedia/public/sample/MonitorSSHActivities/CloudWatchLogs_ssh.yaml</span><br /> <img class="alignnone wp-image-4526 size-full" title="Screenshot of creating the stack" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/01/CreateStack-a.png" alt="Screenshot of creating the stack" width="902" height="375" /></li> 
<li>Choose <strong>Launch</strong> to deploy the stack.</li> 
<li>On the <strong>Specify Details</strong> page, enter the <strong>Stack name</strong>. Then enter the <strong>KeyName</strong>, which is the SSH key pair for the region you use. I use this key-pair later in this post; if you don’t have a key pair for your current region, follow <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener noreferrer">these instructions</a> to create one. The <strong>OperatorEmail</strong> is the CloudWatch alarm recipient email address (this field is mandatory to launch the stack), which is the email address to which SSH activity alarms will be sent. You can use the <strong>SSHLocation</strong> box to limit the IP address range that can access your instances; the default is <span style="font-family: courier">0.0.0/0</span>, which means that any IP can access the instance. After specifying these variables, click <strong>Next.<br /> <img class="alignnone wp-image-4642 size-full" title="Screenshot of the &quot;Specify Details&quot; page" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/25/SpecifyDetails-b.png" alt="Screenshot of the &quot;Specify Details&quot; page" width="900" height="415" /><br /> </strong></li> 
<li>On the <strong>Options </strong>page, tag your instance, and click <strong>Next</strong>. Tags allow you to assign metadata to AWS resources. For example, you can tag a project’s resources and then use the tag to manage, search for, and filter resources. For more information about tagging, see <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html" target="_blank" rel="noopener noreferrer">Tagging Your Amazon EC2 Resources</a>.<br /> <img class="alignnone wp-image-4531 size-full" title="Screenshot of the &quot;Options&quot; page" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/01/Options-a.png" alt="Screenshot of the &quot;Options&quot; page" width="900" height="219" /></li> 
<li>Wait until the CloudFormation template shows <strong>CREATE_COMPLETE</strong>, as shown in the following screenshot. This means your stack was created successfully.<br /> <img class="alignnone wp-image-4421 size-full" title="Screenshot showing the stack was created successfully" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-30-at-1.34.10-AM-a.png" alt="Screenshot showing the stack was created successfully" width="900" height="145" /></li> 
</ol> 
<p>After the stack is created successfully, you have two distinct application servers running, each with a CloudWatch agent. These servers represent a fleet of servers in your infrastructure. Choose the <strong>Outputs</strong> tab to see more details about the resources, such as the public IP addresses of the servers. You will need to use these IP addresses later in this post in order to trigger log events and alarms.</p> 
<p><img class="alignnone wp-image-4534 size-full" title="Screenshot showing the public IP addresses of the servers" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/01/publicIPs.png" alt="Screenshot showing the public IP addresses of the servers" width="900" height="414" /></p> 
<p>The CloudWatch log agent on each server is installed at startup and configured to stream SSH log entries from <span style="font-family: courier">/var/log/secure</span> to CloudWatch via a log stream. CloudWatch aggregates the log streams (<span style="font-family: courier">ssh.log</span>) from the application servers and saves them in a CloudWatch Logs log group. Each log stream is identified by an <span style="font-family: courier">instance-ID</span>, as shown in the following screenshot.</p> 
<p><img class="alignnone wp-image-4533 size-full" title="Screenshot of two log streams' instance-IDs" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/08/01/instanceIDs.png" alt="Screenshot of two log streams' instance-IDs" width="900" height="233" /></p> 
<p>The application servers <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html" target="_blank" rel="noopener noreferrer">assume a role</a> that gives them permissions to create CloudWatch Logs log files and events. CloudFormation also configures two metrics: <span style="font-family: courier">ssh/InvalidUser</span> and <span style="font-family: courier">ssh/Disconnect</span>. The <span style="font-family: courier">ssh/InvalidUser</span> metric sends an alarm when there are more than 2 SSH attempts into any server that include an invalid user name. Similarly, the <span style="font-family: courier">ssh/Disconnect</span> metric creates an alarm when more than 10 SSH disconnect requests come from users within 5 minutes.</p> 
<p>To review the metrics created by CloudFormation, choose <strong>Metrics</strong> in the CloudWatch console. A new <strong>SSH</strong> custom namespace has been created, which contains the two metrics described in the previous paragraph.</p> 
<p><img class="alignnone size-full wp-image-4425" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/2-metrics.png" alt="" width="900" height="545" /></p> 
<p>You should now have two application servers running and two custom CloudWatch metrics and alarms configured. Now, it’s time to generate log events, trigger alarms, and test the configurations.</p> 
<h3>2. &nbsp;Test SSH metrics and alarms</h3> 
<p>Now, let’s try to trigger an alarm by trying to SSH with an invalid user name into one of the servers. Use the key pair you specified when launching the stack and <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html" target="_blank" rel="noopener noreferrer">connect to one of the Linux instances</a> from a terminal window (replace the <strong>placeholder values</strong> in the following command).</p> 
<pre><code class="lang-text">ssh -i <strong>&lt;the-key-pair-you-specified-in-the-CloudFormation-template&gt;</strong> ec2-user@<strong>&lt;ec2 DNS or IP address&gt;</strong></code></pre> 
<p>Now, exit the session and try to sign in as <span style="font-family: courier"><span style="color: #ff0000"><strong>bad-user</strong></span></span>, as shown in the following command.</p> 
<pre><code class="lang-text">ssh -i <strong>&lt;the-key-pair-you-specified-in-the-CloudFormation-template&gt;</strong> <span style="color: #ff0000"><strong>bad-user</strong></span>@<strong>&lt;ec2 DNS or IP address&gt;</strong></code></pre> 
<p>The following command is the same as the previous command, but with the placeholder values replaced by actual values.</p> 
<pre><code class="lang-text">ssh -i &quot;my-keycap&quot; <span style="color: #ff0000"><strong>bad-user</strong></span>@ec2-XX-XXX-XXX.compute-1.amazonaws.com</code></pre> 
<p>Because the alarm triggers after two or more unsuccessful SSH login attempts with an invalid user name in 1 minute, run the preceding command a few times. The server’s log captures the bad SSH login attempts, and after a minute, you should see <span style="font-family: courier">InvalidUserAlarm</span> in the CloudWatch console, as shown in the following screenshot. Choose <strong>Alarms</strong> to see more details. The alarm should disappear after another minute if there are no more SSH login attempts.</p> 
<p><img class="alignnone wp-image-4426" title="Screenshot showing InvalidUserAlarm in the CloudWatch console" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Picture1.png" alt="Screenshot showing InvalidUserAlarm in the CloudWatch console" width="900" height="387" /></p> 
<p>You can also view the history of your alarms by choosing the <strong>History</strong> tab. CloudWatch metrics are saved for 15 months.</p> 
<p>When the CloudFormation stack launches, a topic-registration email is sent to the email address you specified in the template. After you accept the topic registration, you will receive an alarm email with details about the alarm. The email looks like what is shown in the following screenshot.</p> 
<p><img class="alignnone wp-image-4427 size-full" title="Screenshot of the alarm email" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-05-04-at-4.21.10-PM.png" alt="Screenshot of the alarm email" width="900" height="492" /></p> 
<h3>3. &nbsp;Understanding CloudWatch metric filters and their transformation</h3> 
<p>The CloudFormation template includes two alarms, <span style="font-family: courier">InvalidUserAlarm</span> and <span style="font-family: courier">SSHReceiveddisconnectAlarm</span>, and two metric filters. As I mentioned previously, the metric filters define the pattern you want to match in a CloudWatch Logs log group. When a pattern is found, it transforms into an Amazon metric as defined in the <span style="font-family: courier">MetricTransformations</span> section of the metric filter.</p> 
<p>The following is a snippet of the <span style="font-family: courier">InvalidUser</span> metric filter. Each pattern match—denoted by <span style="font-family: courier">FilterPattern</span>—is counted as one metric value as specified in the <span style="font-family: courier">MetricValue</span> parameter in the <span style="font-family: courier">MetricTranformations</span> section. The CloudWatch alarm associated with this metric filter will be triggered when the metric value crosses a specified threshold.</p> 
<pre><code class="lang-text">  InvalidUser:
Type: AWS::Logs::MetricFilter
Properties:
LogGroupName:
Ref: WebServerLogGroup
FilterPattern: &quot;[Mon, day, timestamp, ip, id, status = Invalid, ...]&quot;
MetricTransformations:
- MetricValue: '1'
MetricNamespace: SSH
MetricName: sshInvalidUser</code></pre> 
<p>When a CloudWatch alarm is triggered, the service sends an email to an <a href="https://aws.amazon.com/sns/" target="_blank" rel="noopener noreferrer">Amazon SNS</a> topic with more details about the alarm type, trigger parameters, and status.</p> 
<h3>4. &nbsp;Create a CloudWatch metric filter to identify attempts to SSH into your servers with bad private keys</h3> 
<p>You can create additional metric filters in CloudWatch Logs to provide better visibility into the SSH activity on your servers. Let’s assume you want to know if there are too many attempts to SSH into your servers with bad private keys. If an attempt is made with a bad private key, a line like the following is logged in the SSH log file.</p> 
<pre><code class="lang-text">Apr 27 21:44:49 ip-172-31-38-5 sash[28515]: Connection closed by &lt;<strong>ip address</strong>&gt; [preauth]</code></pre> 
<p>You can produce this log line by modifying the pem file you are using (a <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="noopener noreferrer">pem file</a> holds your private key). In a terminal window, modify your private key by copying and pasting the following lines in the same directory where your key resides.</p> 
<pre><code class="lang-text">$ cat &lt;valid-pem-file&gt; | sed s/./A/25 &gt; bad-keys.pem
$ cat bad-keys.pem | sed s/./A/26 &gt; bad-keys.pem</code></pre> 
<p>These lines simply change the characters at positions 25 and 26 from their current value to the character <span style="font-family: courier">A</span>, keeping the original pem file intact. Alternatively, you can use <span style="font-family: courier">nano &lt;valid-keys&gt;.pem</span> from the command line or any other editor, change a character, save the file as <span style="font-family: courier">bad-keys.pem</span>, and exit the file.</p> 
<p>Now, try to use <span style="font-family: courier">bad-keys.pem</span> to access one of the application servers.</p> 
<pre><code class="lang-text">ssh&nbsp; -i &quot;bad-keys.pem&quot; ec2-user@ec2-XX-XXX-XXX-85.us-west-2.compute.amazonaws.com</code></pre> 
<p>The SSH attempt should fail because you are using a bad private key.</p> 
<pre><code class="lang-text">Permission denied (public key).</code></pre> 
<p>Now, let’s look at the server’s <span style="font-family: courier">ssh.log</span> file from the CloudWatch Logs console and analyze the error log messages. I need to understand the log format in order to configure a new filter. To review the logs, choose <strong>Logs</strong> in the navigation pane, and select the log group that was created by CloudFormation (it starts with the name you specified when launching the CloudFormation template).</p> 
<p><img class="alignnone wp-image-4428 size-full" title="Screenshot of the ssh.log file" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-26-at-5.34.54-PM-copy.png" alt="Screenshot of the ssh.log file" width="900" height="514" /></p> 
<p>In particular, notice the following line when you try to SSH with a bad private key.</p> 
<p><img class="alignnone wp-image-4429 size-full" title="Screenshot of one line of the ssh.log file" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-26-at-5.34.54-PM.png" alt="Screenshot of one line of the ssh.log file" width="740" height="18" /></p> 
<p>Let’s add a metric filter to capture this line so that we can use this metric later when we build an SSH Dashboard. Copy the following line to the <strong>Filter events</strong> search box at the top of the console screen and press <strong>Enter</strong>.</p> 
<pre><code class="lang-text">[Mon, day, timestamp, ip, id, msg1= Connection, msg2 = closed, ...]
<img class="alignnone wp-image-4430 size-full" title="Screenshot of pasting the line from the ssh.log file into the &quot;Filter events&quot; search box" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-06-23-at-12.14.41-AM.png" alt="Screenshot of pasting the line from the ssh.log file into the &quot;Filter events&quot; search box" width="900" height="275" />
</code></pre> 
<p>You can now see only the lines that match the pattern you specified. These are the lines you want to count and transform into metrics. Each string in the message is represented by a word in the filter. In our example, we are looking for a pattern where the sixth word is <span style="font-family: courier">Connection</span> and the seventh word is <span style="font-family: courier">closed</span>. Other words in the log line are not important in this context. The following image depicts the mapping between a string in a log file and a metric filter.</p> 
<p><img class="alignnone wp-image-4460 size-full" title="Screenshot of the mapping between a string in a log file and a metric filter" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/AssafLogLine-July2017-b.png" alt="" width="900" height="206" /></p> 
<p>To create the metric filter, choose <strong>Logs</strong> in the navigation pane of the CloudWatch console. Choose the log groups to which you want to apply the new metric filter and then choose <strong>Create Metric Filter</strong>. Choose <strong>Next</strong>.</p> 
<p><img class="alignnone wp-image-4441 size-full" title="Screenshot of creating a metric filter" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-28-at-2.56.54-PM.png" alt="Screenshot of creating a metric filter" width="900" height="272" /></p> 
<p>Paste the filter pattern we used previously (the sixth word equals <span style="font-family: courier">Connection</span> and the seventh word equals <span style="font-family: courier">closed</span>) in the <strong>Filter Pattern</strong> box. Select the server you tried to sign in to with the bad private key to <strong>Select Log Data to Test</strong> and click <strong>Test Pattern</strong>. You should see the results that are shown in the following screenshot. When completed, click <strong>Assign Metric.</strong></p> 
<p><img class="alignnone wp-image-4442 size-full" title="Screenshot of applying the filter pattern" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-28-at-3.06.19-PM.png" alt="Screenshot of applying the filter pattern" width="900" height="733" /></p> 
<p>Type <span style="font-family: courier">SSH</span> for the <strong>Metric Namespace</strong> and <span style="font-family: courier">sshClosedConnection-InvalidKeysFilter</span> for <strong>Filter Name</strong>. Choose <strong>Create Filter</strong> to see your new metric filter listed. You can use the newly created metric filter to graph the metrics and set alarms. The alarms can be used to inform your administrator via email of any event you specify. In addition, metrics can be used to generate SNS notification to trigger an <a href="https://aws.amazon.com/lambda/" target="_blank" rel="noopener noreferrer">AWS Lambda</a> function in order to take proactive actions, such as blocking suspicious IP addresses in a <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html#vpc-security-groups" target="_blank" rel="noopener noreferrer">security group</a>.</p> 
<p><img class="alignnone wp-image-4443 size-full" title="Screenshot of creating a filter" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-07-05-at-9.59.03-AM.png" alt="Screenshot of creating a filter" width="890" height="371" /></p> 
<p>Choose <strong>Create Alarm</strong> next to <strong>Filter Name</strong> and follow the instructions to create a <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/AlarmThatSendsEmail.html" target="_blank" rel="noopener noreferrer">CloudWatch alarm</a>.</p> 
<p><img class="alignnone wp-image-4444 size-full" title="Screenshot of the &quot;Create Alarm&quot; option" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-07-05-at-9.59.48-AM.png" alt="Screenshot of the &quot;Create Alarm&quot; option" width="783" height="549" /></p> 
<p>Back at the <strong>Metrics</strong> view, you should now have three SSH metric filters under <strong>Custom Namespaces</strong>. Note that it can take a few minutes for the number of SSH metrics to update from two to three.</p> 
<p><img class="alignnone wp-image-4445 size-full" title="Screenshot showing you now have three SSH metric filters" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/3-Metrics.png" alt="Screenshot showing you now have three SSH metric filters" width="900" height="521" /></p> 
<h3>5. &nbsp;Create a graph by using a CloudWatch dashboard</h3> 
<p>After you have configured the metrics, you can display SSH metrics in a graph. <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch_Dashboards.html" target="_blank" rel="noopener noreferrer">CloudWatch dashboards</a> allow you to create reusable graphs of AWS resources and custom metrics so that you can quickly monitor your operational status and identify issues at a glance. Metrics data is kept for a period of two weeks.</p> 
<p>In the CloudWatch console, choose <strong>Dashboards</strong> in the navigation pane, and then choose <strong>Create dashboard</strong> to create a new graph in a dashboard. Name your dashboard <strong>SSH-Dashboard</strong> and choose <strong>Create dashboard</strong>. Choose <strong>Line Graph</strong> from the graph options and choose <strong>Configure</strong>.</p> 
<p><img class="alignnone wp-image-4457 size-full" title="Screenshot of creating a CloudWatch dashboard" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-28-at-5.01.38-PM-a.png" alt="Screenshot of creating a CloudWatch dashboard" width="500" height="246" /></p> 
<p>In the <strong>Add metric graph</strong> window under <strong>Custom Namespace</strong>, choose <strong>SSH </strong>&gt;<strong> Metrics with no dimensions</strong>. Select all three metrics you have configured (the CloudFormation template configured two metrics and you manually added one more metric).</p> 
<p><img class="alignnone wp-image-4458 size-full" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-28-at-5.05.36-PM-a.png" alt="" width="400" height="583" /></p> 
<p>By default, the metrics are displayed on the graph as an average. However, you configured metrics that are based on summary metrics (for example, the total number of alarms in two minutes). To change the default, choose the <strong>Graphed metrics</strong> tab, and change the statistic from <strong>Average</strong> to <strong>Sum</strong>, as shown in the following screenshot. Also, change the time period from 5 minutes to 1 minute.</p> 
<p><img class="alignnone wp-image-4448 size-full" title="Screenshot of changing the statistic from &quot;Average&quot; to &quot;Sum&quot;" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-04-28-at-5.09.14-PM.png" alt="Screenshot of changing the statistic from &quot;Average&quot; to &quot;Sum&quot;" width="900" height="390" /></p> 
<p>Your graphed metrics should look like the following screenshot. When you have provided all the necessary information, choose <strong>Create Widget.</strong></p> 
<p><img class="alignnone wp-image-4449 size-full" title="Screenshot of thet graphed metrics" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-07-11-at-9.58.06-AM.png" alt="Screenshot of thet graphed metrics" width="900" height="343" /></p> 
<p>You can rename the graph and <a href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/add_remove_text_dashboard.html" target="_blank" rel="noopener noreferrer">add static text</a> to give the console more context. To add a text widget, choose <strong>Widget</strong> and select text. Then edit the widget with <a href="https://en.wikipedia.org/wiki/Markdown" target="_blank" rel="noopener noreferrer">markdown language</a>. Your dashboard may then look like the following screenshot.</p> 
<p><img class="alignnone size-full wp-image-4450" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/29/Screen-Shot-2017-07-11-at-1.58.22-PM.png" alt="" width="900" height="264" /></p> 
<p>The consolidated metrics graph displays the number of SSH attempts with bad private keys, invalid user names, and too many disconnects.</p> 
<h3>Conclusion</h3> 
<p>In this blog post, I demonstrated how to automate the deployment of the CloudWatch Logs agent, create filters and alarms, and write, test, and apply metrics on the fly from the AWS Management Console. You can then visualize the metrics with the AWS Management Console. The solution described in this post gives you monitoring and alarming capabilities that can help you understand the status of and potential risks to your instances and applications. You can easily aggregate logs from many servers and different applications, create alarms, and display logs’ metrics on a graph.</p> 
<p>If you have comments about this post, submit them in the “Comments” section below. If you have questions about the solution in this post, start a new thread on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=138" target="_blank" rel="noopener noreferrer">CloudWatch forum</a>.</p> 
<p>– Assaf</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/amazon-cloudwatch/" rel="tag">Amazon CloudWatch</a>, <a href="https://aws.amazon.com/blogs/security/tag/amazon-cloudwatch-logs/" rel="tag">Amazon CloudWatch Logs</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-iam/" rel="tag">AWS IAM</a>, <a href="https://aws.amazon.com/blogs/security/tag/cloudwatch-dashboards/" rel="tag">CloudWatch dashboards</a>, <a href="https://aws.amazon.com/blogs/security/tag/cloudwatch-logs-agent/" rel="tag">CloudWatch Logs agent</a>, <a href="https://aws.amazon.com/blogs/security/tag/log-group/" rel="tag">log group</a>, <a href="https://aws.amazon.com/blogs/security/tag/log-stream/" rel="tag">log stream</a>, <a href="https://aws.amazon.com/blogs/security/tag/metric/" rel="tag">metric</a>, <a href="https://aws.amazon.com/blogs/security/tag/metric-filter/" rel="tag">metric filter</a>, <a href="https://aws.amazon.com/blogs/security/tag/ssh/" rel="tag">SSH</a>, <a href="https://aws.amazon.com/blogs/security/tag/ssh-logs/" rel="tag">SSH logs</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4411');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">How to Use AWS Organizations to Automate End-to-End Account Creation</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">David Schonbrun</span></span> | on 
<time property="datePublished" datetime="2017-07-24T06:54:53+00:00">24 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/aws-organizations/" title="View all posts in AWS Organizations*"><span property="articleSection">AWS Organizations*</span></a>, <a href="https://aws.amazon.com/blogs/security/category/how-to/" title="View all posts in How-To*"><span property="articleSection">How-To*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/how-to-use-aws-organizations-to-automate-end-to-end-account-creation/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4071" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4071&amp;disqus_title=How+to+Use+AWS+Organizations+to+Automate+End-to-End+Account+Creation&amp;disqus_url=https://aws.amazon.com/blogs/security/how-to-use-aws-organizations-to-automate-end-to-end-account-creation/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4071');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p><a href="https://aws.amazon.com/organizations/" target="_blank" rel="noopener noreferrer">AWS Organizations</a>&nbsp;offers new capabilities for managing AWS accounts, including automated account creation via the <a href="http://docs.aws.amazon.com/organizations/latest/APIReference/Welcome.html" target="_blank" rel="noopener noreferrer">Organizations API</a>. For example, you can bring new development teams onboard by using the Organizations API to create an account, <a href="https://aws.amazon.com/cloudformation/" target="_blank" rel="noopener noreferrer">AWS CloudFormation</a> templates to configure the account (such as for <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS Identity and Access Management</a> [IAM] and networking), and <a href="https://aws.amazon.com/blogs/security/announcing-aws-organizations-centrally-manage-multiple-aws-accounts/" target="_blank" rel="noopener noreferrer">service control policies</a> (SCPs) to help enforce corporate policies.</p> 
<p>In this blog post, I demonstrate the step-by-step process for end-to-end account creation in Organizations as well as how to automate the entire process. I also show how to move a new account into an organizational unit (OU).</p> 
<h3>Process overview</h3> 
<p>The following process flow diagram illustrates the steps required to create an account, configure the account, and then move it into an OU so that the account can take advantage of the centralized <a href="http://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html" target="_blank" rel="noopener noreferrer">SCP functionality</a> in Organizations. The tasks in the blue nodes occur in the master account in the organization in question, and the task in the orange node occurs in the new member account I create. In this post, I provide a script (in both Bash/CLI and Python) that you can use to automate this account creation process, and I walk through each step shown in the diagram to explain the process in detail. For the purposes of this post, I use the <a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener noreferrer">AWS CLI</a> in combination with CloudFormation to create and configure an account.<span id="more-4071"></span></p> 
<p><img class="alignnone wp-image-4330 size-full" title="The process flow diagram of this post's solution" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/19/DavidSDiagram-071917.png" alt="The process flow diagram of this post's solution" width="898" height="545" /></p> 
<b>The account creation process</b> 
<p>Follow the steps in this section to create an account, configure it, and move it into an OU. I am also providing a&nbsp;<a href="https://s3.amazonaws.com/awsiammedia/public/sample/AWSOrganizationsAutomateEndtoEndAccountCreation/AWSOrganizations_AutomateEndtoEndAccountCreation_ScriptandTemplates.zip" target="_blank" rel="noopener noreferrer">script and CloudFormation templates</a>&nbsp;that you can use to automate the entire process.</p> 
<h3>1. Sign in to AWS Organizations</h3> 
<p>In order to create an account, you must <a href="https://console.aws.amazon.com/organizations/" target="_blank" rel="noopener noreferrer">sign in</a> to your organization’s master account with a minimum of the following permissions:</p> 
<ul> 
<li><span style="font-family: courier">organizations:DescribeOrganization</span></li> 
<li><span style="font-family: courier">organizations:CreateAccount</span></li> 
</ul> 
<h3>2. Create a new member account</h3> 
<p>After signing in to your organization’s master account, <a href="http://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_accounts_create.html" target="_blank" rel="noopener noreferrer">create a new member account</a>. Before you can create the member account, you need three pieces of information:</p> 
<ul> 
<li><strong>An account name</strong> – The friendly name of the member account, which you can find on the <strong>Accounts</strong> tab in the master account.</li> 
<li><strong>An email address</strong> – The email address of the owner of the new member account. This email address is used by AWS when we need to contact the account owner.</li> 
<li><strong>An IAM role name</strong> – The name of an IAM role that Organizations automatically preconfigures in the new member account. This role trusts the master account, allowing users in the master account to assume the role, as permitted by the master account administrator. The role also has administrator permissions in the new member account. If you do not change the role’s name, the name defaults to <span style="font-family: courier">OrganizationAccountAccessRole</span>.</li> 
</ul> 
<p>The following AWS CLI command creates a new member account.</p> 
<pre><code class="lang-text">aws organizations create-account --email <strong>&lt;newAccEmail&gt;</strong> --account-name &quot;<strong>&lt;newAccName&gt;</strong>&quot; --role-name <strong>&lt;roleName&gt;</strong></code></pre> 
<p>To explain the <strong>placeholder values</strong>&nbsp;in the preceding command that you must update with your own values:</p> 
<ul> 
<li><strong>newAccEmail</strong> – The email address of the owner of the new member account. This email address must <em>not</em> already be associated with another AWS account.</li> 
<li><strong>newAccName</strong> – The friendly name of the new member account.</li> 
<li><strong>roleName</strong> – The name of an IAM role that Organizations automatically preconfigures in the new member account. The default name is <span style="font-family: courier">OrganizationAccountAccessRole</span>.</li> 
</ul> 
<p>This CLI command returns a <span style="font-family: courier">request_id</span> that uniquely identifies the request, a value that is required for in Step 3.</p> 
<p><strong>Important: </strong> When you create an account using Organizations, you currently cannot remove this account from your organization. This, in turn, can prevent you from later deleting the organization.</p> 
<h3>3. Verify account creation</h3> 
<p>Account creation may take a few seconds to complete, so before doing anything with the newly created account, you must first verify the account creation status. To check the status, you must have at least the following permission:</p> 
<ul> 
<li><span style="font-family: courier">organizations:DescribeCreateAccountStatus</span></li> 
</ul> 
<p>The following CLI command, with the <span style="font-family: courier">request_id</span> returned in the previous step as an input parameter, verifies that the account was created:</p> 
<pre><code class="lang-text">aws organizations describe-create-account-status --create-account-request-id <strong>&lt;request_id&gt;</strong></code></pre> 
<p>The command returns the state of your account creation request and can have three different values: <span style="font-family: courier">IN_PROGRESS</span>, <span style="font-family: courier">SUCCEEDED</span>, and <span style="font-family: courier">FAILED</span>.</p> 
<h3>4. Assume a role</h3> 
<p>After you have verified that the new account has been created, configure the account. In order to configure the newly created account, you must sign in with a user who has permission to assume the role submitted in the <span style="font-family: courier">createAccount</span> API call. In the example in Step 1, I named the role <span style="font-family: courier">OrganizationAccountAccessRole</span>; however, if you revised the name of the role, you must use that revised name when assuming the role. Note that when an account is created from within an organization, cross-account trust between the master and programmatically created accounts is automatically established.</p> 
<p>The following CLI command assumes a role.</p> 
<pre><code class="lang-text">aws sts assume-role --role-arn &lt;<strong>role-arn</strong>&gt; --role-session-name &lt;&quot;<strong>role-session-name</strong>&quot;&gt;</code></pre> 
<p>To explain the <strong>placeholder values</strong>&nbsp;in the preceding command that you must update with your own values:</p> 
<ul> 
<li><strong>role-arn&nbsp;– </strong>The <a href="http://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html" target="_blank" rel="noopener noreferrer">Amazon Resource Name</a> (ARN) of the role to assume.</li> 
<li><strong>role-session-name&nbsp;– </strong>An identifier for the assumed role session.</li> 
</ul> 
<h3>5. Configure the new account</h3> 
<p>After you assume the role, build the new account’s networking, IAM, and governance resources as explained in this section. Again, to learn more about and download the account creation script and the templates that can automate this process, see “Automating the entire end-to-end process” later in this post.</p> 
<ol type="A"> 
<li>Networking – Amazon VPC, web access control lists (ACLs), and Internet gateway: 
<ol type="1"> 
<li><a href="http://docs.aws.amazon.com/AmazonVPC/latest/GettingStartedGuide/getting-started-ipv4.html" target="_blank" rel="noopener noreferrer">Create a new Amazon VPC</a>&nbsp;to enable you to launch AWS resources in a virtual network that you define.</li> 
<li>Run the script at the end of this post to create a VPC with two subnets (one public subnet and one private subnet) in each of two Availability Zones.</li> 
<li>Set up <a href="http://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html" target="_blank" rel="noopener noreferrer">web ACLs</a>&nbsp;to control traffic in and out of the subnets. You can set up network ACLs with rules similar to your security groups in order to add an additional layer of security to your VPC.</li> 
<li>Connect your VPC to remote networks by using a <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpn-connections.html" target="_blank" rel="noopener noreferrer">VPN connection</a>.</li> 
<li>If the resources in the VPC require access to the Internet, create an <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Internet_Gateway.html" target="_blank" rel="noopener noreferrer">Internet gateway</a> to allow communication between instances in your VPC and the Internet.</li> 
</ol> </li> 
<li>IAM – Identity provider (IdP), IAM policies, and IAM roles: 
<ol type="1"> 
<li>Many customers use enterprise <a href="https://aws.amazon.com/iam/details/manage-federation/" target="_blank" rel="noopener noreferrer">federated authentication</a> (such as Active Directory) to manage users and permissions centrally outside AWS. If you use federated authentication, <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_create.html" target="_blank" rel="noopener noreferrer">set up an IdP</a>.</li> 
<li>After you set up the IdP, author the <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies" target="_blank" rel="noopener noreferrer">customer managed IAM policies</a> you will use.</li> 
<li>Use <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#aws-managed-policies" target="_blank" rel="noopener noreferrer">AWS managed policies</a> or your customer managed policies to manage access to your AWS resources.</li> 
</ol> </li> 
<li>Governance – AWS Config Rules: 
<ol type="1"> 
<li>Create <a href="http://docs.aws.amazon.com/config/latest/developerguide/evaluate-config.html" target="_blank" rel="noopener noreferrer">AWS Config rules </a>to help manage and enforce standards for resources deployed on AWS.</li> 
<li>Develop a tagging strategy that specifies a minimum set of tags required on every taggable resource. A tagging rule checks that all resources created or edited fulfill this requirement. A noncompliance report is created to document resources that do not meet the AWS Config rule. <a href="http://docs.aws.amazon.com/config/latest/developerguide/evaluate-config_develop-rules_nodejs-sample.html" target="_blank" rel="noopener noreferrer">AWS Lambda scripts</a> can also be launched as a result of AWS Config rules.</li> 
</ol> </li> 
</ol> 
<h3>6. Move the new account into an OU</h3> 
<p>Before allowing your development teams to access the new member account that you configured in the previous steps, <a href="http://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html" target="_blank" rel="noopener noreferrer">apply an SCP</a> to the account to limit the API calls that can be made by all users. To do this, you must move the member account into an OU that has an SCP attached to it.</p> 
<p>An OU is a container for&nbsp;accounts. It can contain other OUs, allowing you to create a hierarchy that resembles an upside-down tree with a “root” at the top and OU “branches” that reach down, ending with accounts that are the “leaves” of the tree. When you attach a policy to one of the nodes in the hierarchy, it affects all the branches (OUs) and leaves (accounts) under it. An OU can have exactly one parent, and currently, each account can be a member of exactly one OU.</p> 
<p>The following CLI command moves an account into an OU.</p> 
<pre><code class="lang-text">aws organizations move-account --account-id &lt;<strong>account_id</strong>&gt; --source-parent-id &lt;<strong>source_parent_id</strong>&gt; --destination-parent-id &lt;<strong>destination_parent_id</strong>&gt;</code></pre> 
<p>To explain the <strong>placeholder values</strong> in the preceding command that you must update with your own values:</p> 
<ul> 
<li><strong>account_id</strong> – The unique identifier (ID) of the account you want to move.</li> 
<li><strong>source_parent_id</strong> – The unique ID of the root or OU from which you want to move the account.</li> 
<li><strong>destination_parent_id</strong> – The unique ID of the root or OU to which you want to move the account.</li> 
</ul> 
<h3>7. Reduce the IAM role permissions</h3> 
<p>The <span style="font-family: courier">OrganizationAccountAccessRole</span> is created with full administrative permissions to enable the creation and development of the new member account. After you complete the development process and you have moved the member account into an OU, <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_manage_modify.html#roles-managingrole-editing-cli" target="_blank" rel="noopener noreferrer">reduce the permissions</a> of <span style="font-family: courier">OrganizationAccountAccessRole</span> to match your anticipated use of this role going forward.</p> 
<b>Automating the entire end-to-end process</b> 
<p>To help you fully automate the process of creating new member accounts, setting up those accounts, and moving new member accounts into an OU, I am providing a script in both Bash/CLI and Python. You can modify or call additional CloudFormation templates as needed.</p> 
<h3>Download the script and CloudFormation templates</h3> 
<p>Download the <a href="https://s3.amazonaws.com/awsiammedia/public/sample/AWSOrganizationsAutomateEndtoEndAccountCreation/AWSOrganizations_AutomateEndtoEndAccountCreation_ScriptandTemplates.zip" target="_blank" rel="noopener noreferrer">script and CloudFormation templates</a>&nbsp;to help you automate this end-to-end process. The global variables in the script are set in the opening lines of code. Update these variables’ values, and they will flow as input parameters to the API commands when the script is executed. I have prepopulated the <span style="font-family: courier">roleName</span> by using AWS best practices nomenclature, but you can use a custom name.</p> 
<p>I am including the following descriptions of the elements of the script to give you a better idea of how the script works.</p> 
<p>Bash/CLI:</p> 
<ul> 
<li><strong><span style="font-family: courier">Organization-new-acc.sh</span></strong> – An example shell script that includes parameters, account creation, and a call to the JSON sample templates for each of three subtasks in Step 5 earlier in this post.</li> 
<li><strong><span style="font-family: courier">CF-VPC.json</span></strong>&nbsp;– An example Cloud Formation template that creates and configures a VPC in the new member account. Each AWS account must have at least one VPC as a networking construct where you can deploy customer resources. Though AWS does create a default VPC when an account is created, you must configure that VPC to meet your needs. This includes creating subnets with specific IP <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Subnets.html" target="_blank" rel="noopener noreferrer">Classless Inter-Domain Routing (CIDR) blocks</a>, creating gateways (including an <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Internet_Gateway.html" target="_blank" rel="noopener noreferrer">Internet gateway</a>, a <a href="http://docs.aws.amazon.com/AmazonVPC/latest/NetworkAdminGuide/Introduction.html#CustomerGateway" target="_blank" rel="noopener noreferrer">customer gateway</a>, <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_VPN.html#VPNTunnels" target="_blank" rel="noopener noreferrer">a VPN tunnel</a>, <a href="https://aws.amazon.com/storagegateway/" target="_blank" rel="noopener noreferrer">AWS Storage Gateway</a>, <a href="https://aws.amazon.com/api-gateway/" target="_blank" rel="noopener noreferrer">Amazon API Gateway</a>, and a <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-nat-gateway.html" target="_blank" rel="noopener noreferrer">NAT gateway</a>), and <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/vpc-peering.html" target="_blank" rel="noopener noreferrer">VPC peering connections</a>. Web ACLs are also part of this process to limit the source IP addresses and ports that can access the VPC. The VPC created by this script includes four <a href="http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Subnets.html" target="_blank" rel="noopener noreferrer">subnets</a> across two Availability Zones. Two of the subnets are public and two are private.</li> 
<li><strong><span style="font-family: courier">CF-IAM.json</span></strong>&nbsp;– An example Cloud Formation template that creates IAM roles in the new member account. As part of a security baseline, you should develop a standard set of IAM roles and related policies. Update this template with the IAM role definitions and policies you want to create in the member account to controls privilege and access.</li> 
<li><strong><span style="font-family: courier">CF-ConfigRules.json</span></strong>&nbsp;– An example Cloud Formation template that creates an AWS Config rule to enforce tagging standards on resources created in the new account.</li> 
<li><strong><span style="font-family: courier">Organization_Output.docx</span></strong>&nbsp;– Example output of the results from running <span style="font-family: courier">Organization-new-acc.sh</span>.</li> 
</ul> 
<p>Python:</p> 
<ul> 
<li><strong><span style="font-family: courier">Create_account_with_iam.py</span></strong><em> – </em>An example Python template that creates an account, moves it into an OU, applies an SCP, and then calls additional templates to deploy resources. <span style="font-family: courier">CF-VPC.JSON</span> can be called by this template if you first customize the <span style="font-family: courier">.json</span> file.</li> 
</ul> 
<ul> 
<li><strong><span style="font-family: courier">Baseline.yml</span></strong> – An example CloudFormation template for creating a new IAM administrative user, IAM user group, IAM role, and IAM policy in the account.</li> 
</ul> 
<h3>Summary</h3> 
<p>In this post, I have demonstrated the step-by-step process for end-to-end account creation in Organizations as well as how to automate the entire process. I also showed how to move a new account into an OU. This solution should save you some time and help you avoid common issues that tend to crop up in the manual account-creation process. To learn more about the features of Organizations, see the <a href="http://docs.aws.amazon.com/organizations/latest/userguide/orgs_introduction.html">AWS Organizations User Guide</a>. For more information about the APIs used in this post, see the <a href="http://docs.aws.amazon.com/organizations/latest/APIReference/Welcome.html">Organizations API Reference</a>.</p> 
<p>If you have comments about this blog post, submit them in the “Comments” section below. If you have implementation or troubleshooting questions, start a new thread on the&nbsp;<a href="https://forums.aws.amazon.com/forum.jspa?forumID=219">Organizations forum</a>.</p> 
<p>– David</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/account-creation/" rel="tag">account creation</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-accounts/" rel="tag">AWS Accounts</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-cloudformation/" rel="tag">AWS CloudFormation</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-organizations/" rel="tag">AWS Organizations</a>, <a href="https://aws.amazon.com/blogs/security/tag/devops-automation/" rel="tag">DevOps automation</a>, <a href="https://aws.amazon.com/blogs/security/tag/organizational-unit/" rel="tag">organizational unit</a>, <a href="https://aws.amazon.com/blogs/security/tag/ous/" rel="tag">OUs</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4071');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">How to Use Batch References in Amazon Cloud Directory to Refer to New Objects in a Batch Request</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Vineeth Harikumar</span></span> | on 
<time property="datePublished" datetime="2017-07-19T06:39:01+00:00">19 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/amazon-cloud-directory/" title="View all posts in Amazon Cloud Directory"><span property="articleSection">Amazon Cloud Directory</span></a>, <a href="https://aws.amazon.com/blogs/security/category/how-to/" title="View all posts in How-To*"><span property="articleSection">How-To*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/how-to-use-batch-references-in-amazon-cloud-directory-to-refer-to-new-objects-in-a-batch-request/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4248" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4248&amp;disqus_title=How+to+Use+Batch+References+in+Amazon+Cloud+Directory+to+Refer+to+New+Objects+in+a+Batch+Request&amp;disqus_url=https://aws.amazon.com/blogs/security/how-to-use-batch-references-in-amazon-cloud-directory-to-refer-to-new-objects-in-a-batch-request/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4248');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p>In <a href="https://aws.amazon.com/clouddirectory/" target="_blank" rel="noopener noreferrer">Amazon Cloud Directory</a>, it’s often necessary to add new objects or add relationships between new objects and existing objects to reflect changes in a real-world hierarchy. With Cloud Directory, you can make these changes efficiently by using batch references within batch operations.</p> 
<p>Let’s say I want to take an existing child object in a hierarchy, detach it from its parent, and reattach it to another part of the hierarchy. A simple way to do this would be to make a call to get the object’s unique identifier, another call to detach the object from its parent using the unique identifier, and a third call to attach it to a new parent. However, if I use batch references within a batch write operation, I can perform all three of these actions in the same request, greatly simplifying my code and reducing the round trips required to make such changes.</p> 
<p>In this post, I demonstrate how to use batch references in a single write request to simplify adding and restructuring a Cloud Directory hierarchy. I have used the <a href="https://aws.amazon.com/sdk-for-java/" target="_blank" rel="noopener noreferrer">AWS SDK for Java</a> for all the sample code in this post, but you can use <a href="https://aws.amazon.com/tools/" target="_blank" rel="noopener noreferrer">other language SDKs</a> or the <a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener noreferrer">AWS CLI</a> in a similar way.</p> 
<h3><strong>Using batch references</strong></h3> 
<p>In my <a href="https://aws.amazon.com/blogs/security/write-and-read-multiple-objects-in-amazon-cloud-directory-by-using-batch-operations/" target="_blank" rel="noopener noreferrer">previous post</a>, I demonstrated how to add AnyCompany’s North American warehouses to a global network of warehouses. As time passes and demand grows, AnyCompany launches multiple warehouses in North American cities to fulfill customer orders with continued efficiency. This requires the company to restructure the network to group warehouses in the same region so that the company can apply similar standards to them, such as delivery times, delivery areas, and types of products sold.<span id="more-4248"></span></p> 
<p>For instance, in the <span style="font-family: courier">NorthAmerica</span> object (see the following diagram), AnyCompany has launched two new warehouses in the Phoenix (<span style="font-family: courier">PHX</span>) area: <span style="font-family: courier">PHX_2</span> and <span style="font-family: courier">PHX_3</span>. AnyCompany wants to add these new warehouses to the network and regroup them with existing warehouse&nbsp;<span style="font-family: courier">PHX_1</span>&nbsp;under the new node, <span style="font-family: courier">PHX</span>.</p> 
<p>The state of the hierarchy before this regrouping is shown in the following diagram, where I added the <span style="font-family: courier">NorthAmerica</span> warehouses (also represented as <span style="font-family: courier">NA</span> in the diagram) to the larger network of AnyCompany’s warehouses.</p> 
<p><img class="alignnone wp-image-4246 size-full" title="Diagram showing the state of the hierarchy before this post's regrouping" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/11/Diagram2-Vineeth-July2017-b.png" alt="Diagram showing the state of the hierarchy before this post's regrouping" width="900" height="495" /></p> 
<h3>Adding and grouping new warehouses in the NorthAmerica network</h3> 
<p>I want to add and group the new warehouses with a single request, and using batch references in a batch write lets me do that. A batch reference is just another way of using&nbsp;object references that you are allowed to define arbitrarily. This allows you to chain operations, which means using the return value from one operation in a subsequent operation within the same batch write request</p> 
<p>Let’s say I have a batch write request&nbsp;with two batch operations: operation A&nbsp;and operation B. Both batch operations operate on the same object X. In operation A, I use the object X found at <span style="font-family: courier">/NorthAmerica/Phoenix</span>, and I assign it to a batch reference that I call <span style="font-family: courier">referencePhoenix</span>. In operation B, I want to modify the same object X, so I use <span style="font-family: courier">referencePhoenix</span> as the object reference that points to the same unique&nbsp;object X used in operation A. I also will use the same helper method implementation from my <a href="https://aws.amazon.com/blogs/security/write-and-read-multiple-objects-in-amazon-cloud-directory-by-using-batch-operations/" target="_blank" rel="noopener noreferrer">previous post</a> for <span style="font-family: courier">getBatchCreateOperation</span>. To learn more about batch references, see the <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_ObjectReference.html" target="_blank" rel="noopener noreferrer">ObjectReference documentation</a>.</p> 
<p>To add and group the new warehouses, I will take advantage of batch references to sequentially:</p> 
<ol> 
<li>Detach <span style="font-family: courier">PHX_1</span> from the <span style="font-family: courier">NA</span> node and maintain a reference to <span style="font-family: courier">PHX_1</span>.</li> 
<li>Create a new child node, <span style="font-family: courier">PHX</span>, and attach it to the <span style="font-family: courier">NA</span> node.</li> 
<li>Create <span style="font-family: courier">PHX_2</span> and <span style="font-family: courier">PHX_3</span> nodes for the new warehouses.</li> 
<li>Link all three nodes—<span style="font-family: courier">PHX_1</span> (using the batch reference), <span style="font-family: courier">PHX_2</span>, and <span style="font-family: courier">PHX_3</span>—to the <span style="font-family: courier">PHX</span> node.</li> 
</ol> 
<p>The following code example achieves these changes in a single batch by using references. First, the code sets up a <span style="font-family: courier">createObjectPHX</span> operation to create the <span style="font-family: courier">PHX</span> parent object and attach it to the parent <span style="font-family: courier">NorthAmerica</span> object. It then sets up <span style="font-family: courier">createObjectPHX_2</span> and <span style="font-family: courier">createObjectPHX_3</span> and attaches these new objects to the new <span style="font-family: courier">PHX</span> object. The code then sets up a <span style="font-family: courier">detachObject</span> to detach the current <span style="font-family: courier">PHX_1</span> object from its parent and assign it to a batch reference. The last operation uses that same batch reference to attach the <span style="font-family: courier">PHX_1</span> object to the newly created <span style="font-family: courier">PHX</span> object. The code example orders these steps sequentially in a batch write operation.</p> 
<pre><code class="lang-text">   BatchWriteOperation createObjectPHX = getBatchCreateOperation(
&quot;PHX&quot;,
directorySchemaARN,
&quot;/NorthAmerica&quot;,
&quot;Phoenix&quot;);
BatchWriteOperation createObjectPHX_2 = getBatchCreateOperation(
&quot;PHX_2&quot;,
directorySchemaARN,
&quot;/NorthAmerica/Phoenix&quot;,
&quot;PHX_2&quot;);
BatchWriteOperation createObjectPHX_3 = getBatchCreateOperation(
&quot;PHX_3&quot;,
directorySchemaARN,
&quot;/NorthAmerica/Phoenix&quot;,
&quot;PHX_3&quot;);
BatchDetachObject detachObject = new BatchDetachObject()
.withBatchReferenceName(&quot;<strong>referenceToPHX_1</strong>&quot;)
.withLinkName(&quot;Phoenix&quot;)
.withParentReference(new ObjectReference()
.withSelector(&quot;/NorthAmerica&quot;));
BatchAttachObject attachObject = new BatchAttachObject()
.withChildReference(new ObjectReference().withSelector(&quot;#referenceToPHX_1&quot;))
.withLinkName(&quot;PHX_1&quot;)
.withParentReference(new ObjectReference()
.withSelector(&quot;/NorthAmerica/Phoenix&quot;));
BatchWriteOperation detachOperation = new BatchWriteOperation()
.withDetachObject(detachObject);
BatchWriteOperation attachOperation = new BatchWriteOperation()
.withAttachObject(attachObject);
BatchWriteRequest request = new BatchWriteRequest();
request.setDirectoryArn(directoryARN);
request.setOperations(Lists.newArrayList(
detachOperation,
createObjectPHX,
createObjectPHX_2,
createObjectPHX_3,
attachOperation));
client.batchWrite(request);</code></pre> 
<p>In the preceding code example, I use the batch reference, <strong><span style="font-family: courier">referenceToPHX_1</span></strong>, in the same batch write operation because I do not have to know the object identifier of that object. If I couldn’t use such a batch reference, I would have to use separate requests to get the <span style="font-family: courier">PHX_1</span> identifier, detach it from the <span style="font-family: courier">NA</span> node, and then attach it to the new <span style="font-family: courier">PHX</span> node.</p> 
<p>I now have the network configuration I want, as shown in the following diagram. I have used a combination of batch operations with batch references to bring new warehouses into the network and regroup them within the same local group of warehouses.</p> 
<p><img class="aligncenter wp-image-4252 size-full" title="Diagram showing the desired network configuration" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/11/Diagram4-Vineeth-July2017.png" alt="Diagram showing the desired network configuration" width="497" height="529" /></p> 
<h3>Summary</h3> 
<p>In this post, I have shown how you can use batch references in a single batch write request to simplify adding and restructuring your existing hierarchies in Cloud Directory. You can use batch references in scenarios where you want to get an object identifier, but don’t want the overhead of using a read operation before a write operation. Instead, you can use a batch reference to refer to an object as part of the intermediate batch operation. To learn more about batch operations, see <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/batches.html" target="_blank" rel="noopener noreferrer">Batches</a>, <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchWrite.html" target="_blank" rel="noopener noreferrer">BatchWrite</a>, and <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchRead.html" target="_blank" rel="noopener noreferrer">BatchRead</a>.</p> 
<p>If you have comments about this post, submit them in the “Comments” section below. If you have implementation questions, start a new thread on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=180" target="_blank" rel="noopener noreferrer">Directory Service forum</a>.</p> 
<p>– Vineeth</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/amazon-cloud-directory/" rel="tag">Amazon Cloud Directory</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-cli/" rel="tag">AWS CLI</a>, <a href="https://aws.amazon.com/blogs/security/tag/batch-read-operations/" rel="tag">batch read operations</a>, <a href="https://aws.amazon.com/blogs/security/tag/batch-references/" rel="tag">batch references</a>, <a href="https://aws.amazon.com/blogs/security/tag/batch-write-operations/" rel="tag">batch write operations</a>, <a href="https://aws.amazon.com/blogs/security/tag/cloud-directory-apis/" rel="tag">Cloud Directory APIs</a>, <a href="https://aws.amazon.com/blogs/security/tag/java-sdk/" rel="tag">Java SDK</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4248');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">Write and Read Multiple Objects in Amazon Cloud Directory by Using Batch Operations</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Vineeth Harikumar</span></span> | on 
<time property="datePublished" datetime="2017-07-18T06:31:57+00:00">18 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/amazon-cloud-directory/" title="View all posts in Amazon Cloud Directory"><span property="articleSection">Amazon Cloud Directory</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/write-and-read-multiple-objects-in-amazon-cloud-directory-by-using-batch-operations/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4233" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4233&amp;disqus_title=Write+and+Read+Multiple+Objects+in+Amazon+Cloud+Directory+by+Using+Batch+Operations&amp;disqus_url=https://aws.amazon.com/blogs/security/write-and-read-multiple-objects-in-amazon-cloud-directory-by-using-batch-operations/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4233');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p><a href="https://aws.amazon.com/cloud-directory/" target="_blank" rel="noopener noreferrer">Amazon Cloud Directory</a> is a hierarchical data store that enables you to build flexible, cloud-native directories for organizing hierarchies of data along multiple dimensions. For example, you can create an organizational structure that you can navigate through multiple hierarchies for reporting structure, location, and cost center.</p> 
<p>In this blog post, I demonstrate how you can use <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/welcome.html" target="_blank" rel="noopener noreferrer">Cloud Directory APIs</a> to write and read multiple objects by using batch operations. With <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchWrite.html" target="_blank" rel="noopener noreferrer">batch write operations</a>, you can execute a sequence of operations atomically—meaning that all of the write operations must occur, or none of them do. You also can make your application efficient by reducing the number of required round trips to read and write objects to your directory. I have used the <a href="https://aws.amazon.com/sdk-for-java/" target="_blank" rel="noopener noreferrer">AWS SDK for Java</a> for all the sample code in this blog post, but you can use <a href="https://aws.amazon.com/tools/" target="_blank" rel="noopener noreferrer">other language SDKs</a> or the <a href="https://aws.amazon.com/cli/" target="_blank" rel="noopener noreferrer">AWS CLI</a> in a similar way.</p> 
<h3>Using batch write operations</h3> 
<p>To demonstrate batch write operations, let’s say that AnyCompany’s warehouses are organized to determine the fastest methods to ship orders to its customers. In North America, AnyCompany plans to open new warehouses regularly so that the company can keep up with customer demand while continuing to meet the delivery times to which they are committed.</p> 
<p>The following diagram shows part of AnyCompany’s global network, including Asian and European warehouse networks.<span id="more-4233"></span></p> 
<p><img class="alignnone wp-image-4245 size-full" title="Diagram showing AnyCompany's global network" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/11/Diagram1-Vineeth-July2017-b.png" alt="" width="900" height="316" /></p> 
<p>Let’s take a look at how I can use batch write operations to add <span style="font-family: courier">NorthAmerica</span> to AnyCompany’s global network of warehouses, with the first three warehouses in New York City (<span style="font-family: courier">NYC</span>), Las Vegas (<span style="font-family: courier">LAS</span>), and Phoenix (<span style="font-family: courier">PHX</span>).</p> 
<h4>Adding NorthAmerica to the global network</h4> 
<p>To add <span style="font-family: courier">NorthAmerica</span> to the global network, I can use a batch write operation to create and link all the objects in the existing network.</p> 
<p>First, I set up a helper method, which performs repetitive tasks, for the <span style="font-family: courier">getBatchCreateOperation</span> object. The following lines of code help me create an <span style="font-family: courier">NA</span> object for <span style="font-family: courier">NorthAmerica</span> and then attach the three city-related nodes: <span style="font-family: courier">NYC</span>, <span style="font-family: courier">LAS</span>, and <span style="font-family: courier">PHX</span>. Because AnyCompany is planning to grow its network, I add a suffix of <span style="font-family: courier">_1</span> to each city code (such as <span style="font-family: courier">PHX_1</span>), which will be helpful hierarchically when the company adds more warehouses within a city.</p> 
<pre><code class="lang-text">    private BatchWriteOperation getBatchCreateOperation(
String warehouseName,
String directorySchemaARN,
String parentReference,
String linkName) {
SchemaFacet warehouse_facet = new SchemaFacet()
.withFacetName(&quot;warehouse&quot;)
.withSchemaArn(directorySchemaARN);
AttributeKeyAndValue kv = new AttributeKeyAndValue()
.withKey(new AttributeKey()
.withFacetName(&quot;warehouse&quot;)
.withName(&quot;name&quot;)
.withSchemaArn(directorySchemaARN))
.withValue(new TypedAttributeValue()
.withStringValue(warehouseName);
List&lt;SchemaFacet&gt; facets = Lists.newArrayList(warehouse_facet);
List&lt;AttributeKeyAndValue&gt; kvs = Lists.newArrayList(kv);
BatchCreateObject createObject = new BatchCreateObject();
createObject.withParentReference(new ObjectReference()
.withSelector(parentReference));
createObject.withLinkName(linkName);
createObject.withBatchReferenceName(UUID.randomUUID().toString());
createObject.withSchemaFacet(facets);
createObject.withObjectAttributeList(kvs);
return new BatchWriteOperation().withCreateObject
(createObject);
}</code></pre> 
<p>The parameters of this helper method include:</p> 
<ul> 
<li><span style="font-family: courier">warehouseName</span> – The name of the warehouse to create in the <span style="font-family: courier">getBatchCreateOperation</span> object.</li> 
<li><span style="font-family: courier">directorySchemaARN</span> – The Amazon Resource Name (ARN) of the schema applied to the directory.</li> 
<li><span style="font-family: courier">parentReference</span> – The object reference of the parent object.</li> 
<li><span style="font-family: courier">linkName</span> – The unique child path from the parent reference where the object should be attached.</li> 
</ul> 
<p>I then use this helper method to set up multiple <span style="font-family: courier">create</span> operations for <span style="font-family: courier">NorthAmerica</span>, <span style="font-family: courier">NewYork</span>, <span style="font-family: courier">Phoenix</span>, and <span style="font-family: courier">LasVegas</span>. For the sake of simplicity, I use airport codes to stand for the cities (for example, <span style="font-family: courier">NYC</span> stands for <span style="font-family: courier">NewYork</span>).</p> 
<pre><code class="lang-text">   BatchWriteOperation createObjectNA = getBatchCreateOperation(
&quot;NA&quot;,
directorySchemaARN,
&quot;/&quot;,
&quot;NorthAmerica&quot;);
BatchWriteOperation createObjectNYC = getBatchCreateOperation(
&quot;NYC_1&quot;,
directorySchemaARN,
&quot;/NorthAmerica&quot;,
&quot;NewYork&quot;);
BatchWriteOperation createObjectPHX = getBatchCreateOperation(
&quot;PHX_1&quot;,
directorySchemaARN,
&quot;/NorthAmerica&quot;,
&quot;Phoenix&quot;);
BatchWriteOperation createObjectLAS = getBatchCreateOperation(
&quot;LAS_1&quot;,
directorySchemaARN,
&quot;/NorthAmerica&quot;,
&quot;LasVegas&quot;);
BatchWriteRequest request = new BatchWriteRequest();
request.setDirectoryArn(directoryARN);
request.setOperations(Lists.newArrayList(
createObjectNA,
createObjectNYC,
createObjectPHX,
createObjectLAS));
client.batchWrite(request);</code></pre> 
<p>Running the preceding code results in a hierarchy for the network with NA added to the network, as shown in the following diagram.</p> 
<p><img class="alignnone wp-image-4246 size-full" title="Diagram with NA added to the network" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/11/Diagram2-Vineeth-July2017-b.png" alt="" width="900" height="495" /></p> 
<h3>Using batch read operations</h3> 
<p>Now, let’s say that after I add <span style="font-family: courier">NorthAmerica</span> to AnyCompany’s global network, an analyst wants to see the updated view of the <span style="font-family: courier">NorthAmerica</span> warehouse network as well as some information about the newly introduced warehouse configurations for the <span style="font-family: courier">Phoenix</span> warehouses. To do this, I can use <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchRead.html" target="_blank" rel="noopener noreferrer">batch read operations</a> to get the network of warehouses for <span style="font-family: courier">NorthAmerica</span> as well as specifically request the attributes and configurations of the <span style="font-family: courier">Phoenix</span> warehouses.</p> 
<p>To list the children of the <span style="font-family: courier">NorthAmerica</span> warehouses, I use the <span style="font-family: courier">BatchListObjectChildren</span> API to get all the children at the path, <span style="font-family: courier">/NorthAmerica</span>. Next, I want to view the attributes of the <span style="font-family: courier">Phoenix</span> object, so I use the <span style="font-family: courier">BatchListObjectAttributes</span> API to read all the attributes of the object at <span style="font-family: courier">/NorthAmerica/Phoenix</span>, as shown in the following code example.</p> 
<pre><code class="lang-text">    BatchListObjectChildren listObjectChildrenRequest = new BatchListObjectChildren()
.withObjectReference(new ObjectReference().withSelector(&quot;/NorthAmerica&quot;));
BatchListObjectAttributes listObjectAttributesRequest = new BatchListObjectAttributes()
.withObjectReference(new ObjectReference()
.withSelector(&quot;/NorthAmerica/Phoenix&quot;));
BatchReadRequest batchRead = new BatchReadRequest()
.withConsistencyLevel(ConsistencyLevel.EVENTUAL)
.withDirectoryArn(directoryArn)
.withOperations(Lists.newArrayList(listObjectChildrenRequest, listObjectAttributesRequest));
BatchReadResult result = client.batchRead(batchRead);</code></pre> 
<h3>Exception handling</h3> 
<p>Batch operations in Cloud Directory might sometimes fail, and it is important to know how to handle such failures, which differ for write operations and read operations.</p> 
<h4>Batch write operation failures</h4> 
<p>If a batch write operation fails, Cloud Directory fails the entire batch operation and returns an exception. The exception contains the index of the operation that failed along with the exception type and message. If you see <span style="font-family: courier">RetryableConflictException</span>, you can try again with exponential backoff. A simple way to do this is to double the amount of time you wait each time you get an exception or failure. For example, if your first batch write operation fails, wait 100 milliseconds and try the request again. If the second request fails, wait 200 milliseconds and try again. If the third request fails, wait 400 milliseconds and try again.</p> 
<h4>Batch read operation failures</h4> 
<p>If a batch read operation fails, the response contains either a successful response or an exception response. Individual batch read operation failures do not cause the entire batch read operation to fail—Cloud Directory returns individual success or failure responses for each operation.</p> 
<h3>Limits of batch operations</h3> 
<p>Batch operations are still constrained by the same Cloud Directory limits as other Cloud Directory APIs. A single batch operation does not limit the number of operations, but the total number of nodes or objects being written or edited in a single batch operation have enforced limits. For example, a total of 20 objects can be written in a single batch operation request to Cloud Directory, regardless of how many individual operations there are within that batch. Similarly, a total of 200 objects can be read in a single batch operation request to Cloud Directory. For more information, see <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/limits.html#limits_cd" target="_blank" rel="noopener noreferrer">limits on batch operations</a>.</p> 
<h3>Summary</h3> 
<p>In this post, I have demonstrated how you can use batch operations to operate on multiple objects and simplify making complicated changes across hierarchies. In my next post, I will demonstrate how to use batch references within batch write operations. To learn more about batch operations, see <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/batches.html" target="_blank" rel="noopener noreferrer">Batches</a>, <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchWrite.html" target="_blank" rel="noopener noreferrer">BatchWrite</a>, and <a href="http://docs.aws.amazon.com/directoryservice/latest/APIReference/API_BatchRead.html" target="_blank" rel="noopener noreferrer">BatchRead</a>.</p> 
<p>If you have comments about this post, submit them in the “Comments” section below. If you have implementation questions, start a new thread on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=180" target="_blank" rel="noopener noreferrer">Directory Service forum</a>.</p> 
<p>– Vineeth</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/amazon-cloud-directory/" rel="tag">Amazon Cloud Directory</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-cli/" rel="tag">AWS CLI</a>, <a href="https://aws.amazon.com/blogs/security/tag/batch-read-operations/" rel="tag">batch read operations</a>, <a href="https://aws.amazon.com/blogs/security/tag/batch-write-operations/" rel="tag">batch write operations</a>, <a href="https://aws.amazon.com/blogs/security/tag/cloud-directory-apis/" rel="tag">Cloud Directory APIs</a>, <a href="https://aws.amazon.com/blogs/security/tag/java-sdk/" rel="tag">Java SDK</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4233');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">Coming Soon: Improvements to How You Sign In to Your AWS Account</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Siraj Valiya Valappil</span></span> | on 
<time property="datePublished" datetime="2017-07-17T06:09:18+00:00">17 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/aws-identity-and-access-management-iam/" title="View all posts in AWS Identity and Access Management (IAM)*"><span property="articleSection">AWS Identity and Access Management (IAM)*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/coming-soon-improvements-to-how-you-sign-in-to-your-aws-account/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4218" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4218&amp;disqus_title=Coming+Soon%3A+Improvements+to+How+You+Sign+In+to+Your+AWS+Account&amp;disqus_url=https://aws.amazon.com/blogs/security/coming-soon-improvements-to-how-you-sign-in-to-your-aws-account/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4218');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p><strong>Update from August 25, 2017:</strong>&nbsp;These improvements are now live. For more details, see&nbsp;<a href="https://aws.amazon.com/blogs/security/now-available-improvements-to-how-you-sign-in-to-your-aws-account/" target="_blank" rel="noopener noreferrer">Now Available: Improvements to How You Sign In to Your AWS Account</a>.</p> 
<hr /> 
<p>Coming soon, AWS will improve the way you sign in to your AWS account. Whether you sign in as your account’s <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/id_root-user.html" target="_blank" rel="noopener noreferrer">root user</a> or an <a href="https://aws.amazon.com/iam/" target="_blank" rel="noopener noreferrer">AWS Identity and Access Management</a> (IAM) user, you will be able to sign in from the AWS Management Console’s home page. This means that if you sign in as an IAM user, you will no longer be required to use an account-specific URL. However, the account-specific URL you use to sign in today will continue to work.</p> 
<p>In the new sign-in experience, you can sign in from the homepage using either your root user’s or IAM user’s credentials. In the first step, root users will enter their email address; IAM users will enter their <a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/console_account-alias.html" target="_blank" rel="noopener noreferrer">account ID (or account alias)</a>. In the second step, root users will enter their password; IAM users will enter their user name and password.</p> 
<p>In this blog post, I explain the improvements that are coming soon to the way you sign in to your AWS account as a root user or IAM user. If you use a password manager to help you sign in to AWS, you may need to make updates so that it will work with the new sign-in experience.<span id="more-4218"></span></p> 
<b>The new sign-in experience</b> 
<p>The new AWS sign-in experience will allow both root users and IAM users to sign in using the <strong>Sign In to the Console</strong> link on the AWS home page.</p> 
<h3>Step 1: For root users and IAM users</h3> 
<p>As shown in the following screenshot, to sign in as a root user, you will type the email address associated with the root account. To sign in as an IAM user, you will type an AWS account ID or account alias. You will then choose <strong>Next</strong> to proceed to Step 2.</p> 
<p>If you usually sign in using the same browser and allow the browser to store AWS cookies, you will skip Step 1 on subsequent sign-in attempts. If you regularly switch users or accounts, AWS recommends that you prevent the sign-in page from storing AWS cookies.</p> 
<p><img class="alignnone wp-image-4296 size-full" title="Step 1: Sign in as a root user or IAM user" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/14/Siraj-July2017-1.jpg" alt="Step 1: Sign in as a root user or IAM user" width="325" height="428" /></p> 
<h3>Step 2: For root users</h3> 
<p>If you enter the email address associated with the root account in Step 1, you will be taken to the second step of signing in to the root account, as shown in the following screenshot. Type the password of the root account and choose <strong>Sign in</strong>. If you enabled <a href="https://aws.amazon.com/iam/details/mfa" target="_blank" rel="noopener noreferrer">multi-factor authentication</a> (MFA) for your root account, you will then be prompted to enter the code from your MFA device. After successful authentication, you will be signed in to the AWS Management Console, and the homepage of your root account will be displayed.</p> 
<p><img class="alignnone wp-image-4297 size-full" title="Step 2: For root users" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/14/Siraj-July2017-3.jpg" alt="Step 2: For root users" width="323" height="375" /></p> 
<h3>Step 2: For IAM users</h3> 
<p>If you enter an AWS account ID or account alias in Step 1, you will be taken to the second step for signing in as an IAM user, as shown in the following screenshot. Type the user name and password of the IAM user, and choose <strong>Sign in</strong>. If MFA has been enabled for your IAM user, you will then be prompted to enter the code from your MFA device. After successful authentication, the IAM user home page will be displayed.</p> 
<p><img class="alignnone wp-image-4298 size-full" title="Step 2: For IAM users" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/14/Siraj-July2017-2.jpg" alt="Step 2: For IAM users" width="324" height="479" /></p> 
<p>With these changes, you may need to make updates to password managers so that they will work with the new sign-in experience. We will publish another Security Blog post when the updated sign-in experience is available.</p> 
<p>If you have comments about the upcoming changes to how your root user and IAM users will sign in to your AWS account, enter a comment in the “Comments” section below. If you have questions, start a new thread on the <a href="https://forums.aws.amazon.com/forum.jspa?forumID=76" target="_blank" rel="noopener noreferrer">IAM forum</a>.</p> 
<p>– Siraj</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/aws-iam/" rel="tag">AWS IAM</a>, <a href="https://aws.amazon.com/blogs/security/tag/iam-user-sign-in/" rel="tag">IAM user sign-in</a>, <a href="https://aws.amazon.com/blogs/security/tag/root-user-sign-in/" rel="tag">root user sign-in</a>, <a href="https://aws.amazon.com/blogs/security/tag/sign-in/" rel="tag">sign-in</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4218');
});
</script> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b><a href="https://aws.amazon.com/blogs/security/aws-adds-12-more-services-to-its-pci-dss-compliance-program/" property="url" rel="bookmark"><span property="name headline">AWS Adds 12 More Services to Its PCI DSS Compliance Program</span></a></b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Sara Duffer</span></span> | on 
<time property="datePublished" datetime="2017-07-13T06:54:22+00:00">13 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/compliance/" title="View all posts in Compliance*"><span property="articleSection">Compliance*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/aws-adds-12-more-services-to-its-pci-dss-compliance-program/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4279" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4279&amp;disqus_title=AWS+Adds+12+More+Services+to+Its+PCI+DSS+Compliance+Program&amp;disqus_url=https://aws.amazon.com/blogs/security/aws-adds-12-more-services-to-its-pci-dss-compliance-program/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4279');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p style="text-align: center"><img class="alignnone wp-image-4288" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/12/PCIBox1.jpg" alt="" width="450" height="222" /></p> 
<p>Twelve more AWS services have obtained <a href="https://aws.amazon.com/compliance/pci-dss-level-1-faqs/" target="_blank" rel="noopener noreferrer">Payment Card Industry Data Security Standard</a> (PCI DSS) compliance, giving you more options, flexibility, and functionality to process and store sensitive payment card data in the AWS Cloud. The services were audited by <a href="https://www.coalfire.com/" target="_blank" rel="noopener noreferrer">Coalfire</a> to ensure that they meet strict <a href="https://www.pcisecuritystandards.org/" target="_blank" rel="noopener noreferrer">PCI DSS standards</a>.</p> 
<p>The newly compliant AWS services are:</p> 
<ul> 
<li><a href="https://aws.amazon.com/api-gateway/" target="_blank" rel="noopener noreferrer">Amazon API Gateway</a></li> 
<li><a href="https://aws.amazon.com/cloudwatch/details/#log-monitoring" target="_blank" rel="noopener noreferrer">Amazon CloudWatch Logs</a></li> 
<li><a href="https://aws.amazon.com/cognito/" target="_blank" rel="noopener noreferrer">Amazon Cognito</a></li> 
<li><a href="https://aws.amazon.com/connect/" target="_blank" rel="noopener noreferrer">Amazon Connect</a></li> 
<li><a href="https://aws.amazon.com/kinesis/streams/" target="_blank" rel="noopener noreferrer">Amazon Kinesis Streams</a></li> 
<li><a href="https://aws.amazon.com/workdocs/" target="_blank" rel="noopener noreferrer">Amazon WorkDocs</a></li> 
<li><a href="https://aws.amazon.com/workspaces/" target="_blank" rel="noopener noreferrer">Amazon WorkSpaces</a></li> 
<li><a href="https://aws.amazon.com/dms/" target="_blank" rel="noopener noreferrer">AWS Database Migration Service</a></li> 
<li><a href="https://aws.amazon.com/directoryservice/" target="_blank" rel="noopener noreferrer">AWS Directory Service</a> (AWS Microsoft AD, Amazon Cloud Directory)</li> 
<li><a href="https://aws.amazon.com/lambda/" target="_blank" rel="noopener noreferrer">AWS Lambda</a></li> 
<li><a href="https://aws.amazon.com/managed-services/" target="_blank" rel="noopener noreferrer">AWS Managed Services</a></li> 
<li><a href="https://aws.amazon.com/opsworks/stacks/" target="_blank" rel="noopener noreferrer">AWS OpsWorks Stacks</a></li> 
</ul> 
<p>AWS now offers <a href="https://aws.amazon.com/compliance/services-in-scope/" target="_blank" rel="noopener noreferrer">42 services</a> that meet PCI DSS standards, putting administrators in better control of their frameworks and making workloads more efficient and cost effective.</p> 
<p>For more information about the AWS PCI DSS compliance program, see <a href="https://aws.amazon.com/compliance/resources/" target="_blank" rel="noopener noreferrer">Compliance Resources</a>, <a href="https://aws.amazon.com/compliance/services-in-scope/" target="_blank" rel="noopener noreferrer">AWS Services in Scope by Compliance Program</a>, and <a href="https://aws.amazon.com/compliance/pci-dss-level-1-faqs/" target="_blank" rel="noopener noreferrer">PCI DSS Compliance</a>.</p> 
<p>– Sara</p> 
</article> 
<article class="post" vocab="http://schema.org/" typeof="TechArticle"> 
<meta property="inLanguage" content="en-US" /> 
<b class="b post-title" property="name headline">How to Configure Even Stronger Password Policies to Help Meet Your Security Standards by Using AWS Directory Service for Microsoft Active Directory</b> 
<footer class="meta">
by 
<span property="author" typeof="Person"><span property="name">Ravi Turlapati</span></span> | on 
<time property="datePublished" datetime="2017-07-12T05:54:24+00:00">12 JUL 2017</time> | in 
<span class="categories"><a href="https://aws.amazon.com/blogs/security/category/security-identity-compliance/aws-directory-service/" title="View all posts in AWS Directory Service*"><span property="articleSection">AWS Directory Service*</span></a>, <a href="https://aws.amazon.com/blogs/security/category/how-to/" title="View all posts in How-To*"><span property="articleSection">How-To*</span></a></span> | 
<a href="https://aws.amazon.com/blogs/security/how-to-configure-even-stronger-password-policies-to-help-meet-your-security-standards-by-using-aws-directory-service-for-microsoft-active-directory/" property="url">Permalink</a> | 
<a id="aws-comment-trigger-4157" href="https://commenting.awsblogs.com/embed.html?disqus_shortname=aws-security-blog&amp;disqus_identifier=4157&amp;disqus_title=How+to+Configure+Even+Stronger+Password+Policies+to+Help+Meet+Your+Security+Standards+by+Using+AWS+Directory+Service+for+Microsoft+Active+Directory&amp;disqus_url=https://aws.amazon.com/blogs/security/how-to-configure-even-stronger-password-policies-to-help-meet-your-security-standards-by-using-aws-directory-service-for-microsoft-active-directory/" data-sandbox-attr="allow-forms allow-scripts allow-popups allow-same-origin" property="discussionUrl"><i class="icon-comment"></i> Comments</a> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4157');
});
</script> | 
<a href="#" role="button" data-share-dialog=""><span class="span icon-share"></span>&nbsp;Share</a> 
<ul> 
</ul> 
</footer> 
<p>With <a href="https://aws.amazon.com/directoryservice/" target="_blank" rel="noopener noreferrer">AWS Directory Service for Microsoft Active Directory (Enterprise Edition)</a>, also known as AWS Microsoft AD, you can now create and enforce custom password policies for your Microsoft Windows users. AWS Microsoft AD now includes five empty password policies that you can edit and apply with standard Microsoft password policy tools such as <a href="https://technet.microsoft.com/en-us/library/dd560651%28v=ws.10%29.aspx" target="_blank" rel="noopener noreferrer">Active Directory Administrative Center</a> (ADAC). With this capability, you are no longer limited to the default Windows password policy. Now, you can configure even stronger password policies and define lockout policies that specify when to lock out an account after login failures.</p> 
<p>In this blog post, I demonstrate how to edit these new password policies to help you meet your security standards by using AWS Microsoft AD. I also introduce the password attributes you can modify and demonstrate how to apply password policies to user groups in your domain.<span id="more-4157"></span></p> 
<h3>Prerequisites</h3> 
<p>The instructions in this post assume that you already have the following components running:</p> 
<ul> 
<li>An active AWS Microsoft AD directory.</li> 
<li>An <a href="https://aws.amazon.com/windows/products/ec2/" target="_blank" rel="noopener noreferrer">Amazon EC2 for Windows Server</a> instance that is domain joined to your AWS Microsoft AD directory and on which you have installed ADAC.</li> 
</ul> 
<p>If you still need to meet these prerequisites before proceeding:</p> 
<ul> 
<li>For information about how to deploy AWS Microsoft AD, see <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/create_managed_ad.html" target="_blank" rel="noopener noreferrer">How to Create a Microsoft AD directory</a>.</li> 
<li>To join an EC2 for Windows Server instance to your AWS Microsoft AD domain on which you run ADAC, see <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/join_windows_instance.html" target="_blank" rel="noopener noreferrer">Manually Add a Windows Instance</a>.</li> 
<li>Follow the steps in <a href="http://docs.aws.amazon.com/directoryservice/latest/admin-guide/install_ad_tools.html" target="_blank" rel="noopener noreferrer">Installing the Active Directory Administration Tools</a> to install Active Directory Administration Tools on your EC2 for Windows Server instance.</li> 
</ul> 
<p><a name="scenariooverview"></a></p> 
<h3>Scenario overview</h3> 
<p>Let’s say I am the Active Directory (AD) administrator of Example Corp. At Example Corp., we have a group of technical administrators, several groups of senior managers, and general, nontechnical employees. I need to create password policies for these groups that match our security standards.</p> 
<p>Our general employees have access only to low-sensitivity information. However, our senior managers regularly access confidential information and we want to enforce password complexity (a mix of upper and lower case letters, numbers, and special characters) to reduce the risk of data theft. For our administrators, we want to enforce password complexity policies to prevent unauthorized access to our system administration tools.</p> 
<p>Our security standards call for the following enforced password and account lockout policies:</p> 
<ul> 
<li><strong>General employees</strong> – To make it easier for nontechnical general employees to remember their passwords, we do not enforce password complexity. However, we want to enforce a minimum password length of 8 characters and a lockout policy after 6 failed login attempts as a minimum bar to protect against unwanted access to our low-sensitivity information. If a general employee forgets their password and becomes locked out, we let them try again in 5 minutes, rather than require escalated password resets. We also want general employees to rotate their passwords every 60 days with no duplicated passwords in the past 10 password changes.</li> 
<li><strong>Senior managers</strong> – For senior managers, we enforce a minimum password length of 10 characters and require password complexity. An account lockout is enforced after 6 failed attempts with an account lockout duration of 15 minutes. Senior managers must rotate their passwords every 45 days, and they cannot duplicate passwords from the past 20 changes.</li> 
<li><strong>Administrators </strong>– For administrators, we enforce password complexity with a minimum password length of 15 characters. We also want to lock out accounts after 6 failed attempts, have password rotation every 30 days, and disallow duplicate passwords in the past 30 changes. When a lockout occurs, we require a special administrator to intervene and unlock the account so that we can be aware of any potential hacking.</li> 
<li><strong>Fine-Grained Password Policy administrators</strong> – To ensure that only trusted administrators unlock accounts, we have two special administrator accounts (<span style="font-family: courier">admin</span> and <span style="font-family: courier">midas</span>) that can unlock accounts. These two accounts have the same policy as the other administrators except they have an account lockout duration of 15 minutes, rather than requiring a password reset. These two accounts are also the accounts used to manage Example Corp.’s password policies.</li> 
</ul> 
<p>The following table summarizes how I edit each of the four policies I intend to use.</p> 
<table border="1" width="0"> 
<tbody> 
<tr> 
<td width="150"><strong>Policy name</strong></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">EXAMPLE-PSO-01</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">EXAMPLE-PSO-02</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">EXAMPLE-PSO-03</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">EXAMPLE-PSO-05</span></td> 
</tr> 
<tr> 
<td width="150"><strong>Precedence</strong></td> 
<td style="text-align: center" width="150">10</td> 
<td style="text-align: center" width="150">20</td> 
<td style="text-align: center" width="150">30</td> 
<td style="text-align: center" width="150">50</td> 
</tr> 
<tr> 
<td width="150"><strong>User group</strong></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">Fine-Grained Password Policy Administrators</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">Other Administrators</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">Senior Managers</span></td> 
<td style="text-align: center" width="150"><span style="font-family: courier">General Employees</span></td> 
</tr> 
<tr> 
<td width="150"><strong>Minimum password length </strong></td> 
<td style="text-align: center" width="127">15</td> 
<td style="text-align: center" width="126">15</td> 
<td style="text-align: center" width="127">10</td> 
<td style="text-align: center" width="121">8</td> 
</tr> 
<tr> 
<td width="150"><strong>Password complexity </strong></td> 
<td style="text-align: center" width="127">Enable</td> 
<td style="text-align: center" width="126">Enable</td> 
<td style="text-align: center" width="127">Enable</td> 
<td style="text-align: center" width="121">Disable</td> 
</tr> 
<tr> 
<td width="150"><strong>Maximum password age</strong></td> 
<td style="text-align: center" width="127">30 days</td> 
<td style="text-align: center" width="126">30 days</td> 
<td style="text-align: center" width="127">45 days</td> 
<td style="text-align: center" width="121">60 days</td> 
</tr> 
<tr> 
<td width="150"><strong>Account complexity</strong></td> 
<td style="text-align: center" width="127">Enable</td> 
<td style="text-align: center" width="126">Enable</td> 
<td style="text-align: center" width="127">Enable</td> 
<td style="text-align: center" width="121">Disable</td> 
</tr> 
<tr> 
<td width="150"><strong>Number of failed logon attempts allowed</strong></td> 
<td style="text-align: center" width="127">6</td> 
<td style="text-align: center" width="126">6</td> 
<td style="text-align: center" width="127">6</td> 
<td style="text-align: center" width="121">6</td> 
</tr> 
<tr> 
<td width="150"><strong>Duration</strong></td> 
<td style="text-align: center" width="127">15 minutes</td> 
<td style="text-align: center" width="126">Not applicable</td> 
<td style="text-align: center" width="127">15 minutes</td> 
<td style="text-align: center" width="121">5 minutes</td> 
</tr> 
<tr> 
<td width="150"><strong>Password history</strong></td> 
<td style="text-align: center" width="127">24</td> 
<td style="text-align: center" width="126">30</td> 
<td style="text-align: center" width="127">20</td> 
<td style="text-align: center" width="121">10</td> 
</tr> 
<tr> 
<td width="150"><strong>Until admin manually unlocks account</strong></td> 
<td style="text-align: center" width="127">Not applicable</td> 
<td style="text-align: center" width="126">Selected</td> 
<td style="text-align: center" width="127">Not applicable</td> 
<td style="text-align: center" width="121">Not applicable</td> 
</tr> 
</tbody> 
</table> 
<p>To implement these password policies, I use 4 of the 5 new password policies available in AWS Microsoft AD:</p> 
<ol> 
<li>I first explain how to configure the password policies.</li> 
<li>I then demonstrate how to apply the four password policies that match Example Corp.’s security standards for these user groups.</li> 
</ol> 
<h3>1. Configure password policies in AWS Microsoft AD</h3> 
<p>To help you get started with password policies, AWS has added the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> AD security group to your AWS Microsoft AD directory. Any user or other security group that is part of the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> group has permissions to edit and apply the five new password policies. By default, your directory <span style="font-family: courier">Admin</span> is part of the new group and can add other users or groups to this group.</p> 
<h4>Adding users to the Fine-Grained Pwd Policy Admins user group</h4> 
<p>Follow these steps to add more users or AD security groups to the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> security group so that they can administer fine-grained password policies:</p> 
<ol> 
<li>Launch ADAC from your managed instance.</li> 
<li>Switch to the <strong>Tree View</strong> and navigate to <strong>CORP &gt; Users</strong>.</li> 
<li>Find the <strong>Fine Grained Pwd Policy Admins</strong> user group. Add any users or groups in your domain to this group.</li> 
</ol> 
<p><a name="edit"></a></p> 
<h4>Edit password policies</h4> 
<p>To edit fine-grained password policies, <a href="https://technet.microsoft.com/en-us/library/dd560651%28v=ws.10%29.aspx" target="_blank" rel="noopener noreferrer">open ADAC</a> from any management instance joined to your domain. Switch to the <strong>Tree View</strong> and navigate to <strong>System &gt; Password Settings Container</strong>. You will see the five policies containing the string <span style="font-family: courier">-PSO-</span> that AWS added to your directory, as shown in the following screenshot. Select a policy to edit it.</p> 
<p><img class="alignnone wp-image-4175 size-full" title="Screenshot showing the five new password policies" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/06/RaviT-July2017-screenshot6.jpg" alt="Screenshot showing the five new password policies" width="851" height="320" /></p> 
<p>After editing the password policy, apply the policy by adding users or AD security groups to these policies by choosing <strong>Add</strong>. The default <strong>domain</strong> GPO applies if you do not configure any of the five password policies. For additional details about using Password Settings Container, go to <a href="https://blogs.technet.microsoft.com/canitpro/2013/05/29/step-by-step-enabling-and-using-fine-grained-password-policies-in-ad/" target="_blank" rel="noopener noreferrer">Step-by-Step: Enabling and Using Fine-Grained Password Policies in AD</a> on the Microsoft TechNet Blog.</p> 
<h4>The password attributes you can edit</h4> 
<p>AWS allows you to edit all of the password attributes except <strong><span style="font-family: courier">Precedence</span></strong> (I explain more about <strong><span style="font-family: courier">Precedence</span></strong> in the next section). These attributes include:</p> 
<ul> 
<li>Password history</li> 
<li>Minimum password length</li> 
<li>Minimum password age</li> 
<li>Maximum password age</li> 
<li>Store password using reversible encryption</li> 
<li>Password must meet complexity requirements</li> 
</ul> 
<p>You also can enforce the following attributes for account lockout settings:</p> 
<ul> 
<li>The number of failed login attempts allowed</li> 
<li>Account lockout duration</li> 
<li>Reset failed login attempts after a specified duration</li> 
</ul> 
<p>For more details about how these attributes affect password enforcement, see <a href="https://technet.microsoft.com/en-us/library/cc770394(v=ws.10).aspx" target="_blank" rel="noopener noreferrer">AD DS: Fine-Grained Password Policies</a> on Microsoft TechNet.</p> 
<h4>Understanding password policy precedence</h4> 
<p>AD password policies have a precedence (a numerical attribute that AD uses to determine the resultant policy) associated with them. Policies with a lower value for <strong><span style="font-family: courier">Precedence</span></strong> have higher priority than other policies. A user inherits all policies that you apply directly to the user or to any groups to which the user belongs. For example, suppose <span style="font-family: courier">jsmith</span> is a member of the <span style="font-family: courier">HR</span> group and also a member of the <span style="font-family: courier">MANAGERS</span> group. If I apply a policy with a <span style="font-family: courier">Precedence</span> of <span style="font-family: courier">50</span> to the <span style="font-family: courier">HR</span> group and a policy with a <span style="font-family: courier">Precedence</span> of <span style="font-family: courier">40</span> to <span style="font-family: courier">MANAGERS</span>, the policy with the <strong><span style="font-family: courier">Precedence</span></strong> value of <span style="font-family: courier">40</span> ranks higher and AD applies that policy to <span style="font-family: courier">jsmith</span>.</p> 
<p>If you apply multiple policies to a user or group, the resultant policy is determined as follows by AD:</p> 
<ol> 
<li>If you apply a policy directly to a user, AD enforces the lowest directly applied password policy.</li> 
<li>If you did not apply a policy directly to the user, AD enforces the policy with the lowest <strong><span style="font-family: courier">Precedence</span></strong> value of all policies inherited by the user through the user’s group membership.</li> 
</ol> 
<p>For more information about AD fine-grained policies, see <a href="https://technet.microsoft.com/en-us/library/cc770394(v=ws.10).aspx" target="_blank" rel="noopener noreferrer">AD DS: Fine-Grained Password Policies</a> on Microsoft TechNet.</p> 
<h3>2. Apply password policies to user groups</h3> 
<p>In this section, I demonstrate how to apply Example Corp.’s password policies. Except in rare cases, I only apply policies by group membership, which ensures that AD does not enforce a lower priority policy on an individual user if have I added them to a group with a higher priority policy.</p> 
<p>Because my directory is new, I use a <a href="https://technet.microsoft.com/pt-pt/library/cc753907(v=ws.10).aspx" target="_blank" rel="noopener noreferrer">Remote Desktop Protocol (RDP) connection</a> to sign in to the Windows Server instance I domain joined to my AWS Microsoft AD directory. Signing in with the <span style="font-family: courier">admin</span> account, I launch ADAC to perform the following tasks:</p> 
<ol> 
<li>First, I set up my groups so that I can apply password policies to them. Later, I can create user accounts and add them to my groups and AD applies the right policy by using the policy precedence and resultant policy algorithms I discussed previously. I start by adding the two special administrative accounts (<span style="font-family: courier">admin</span> and <span style="font-family: courier">midas</span>) that I described previously to the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span>. Because AWS Microsoft AD adds my default <span style="font-family: courier">admin</span> account to <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span>, I only need to create <span style="font-family: courier">midas</span> and then add <span style="font-family: courier">midas</span> to the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> group.</li> 
<li>Next, I create the <span style="font-family: courier">Other Administrators</span>, <span style="font-family: courier">Senior Managers</span>, and <span style="font-family: courier">General Employees</span> groups that I described previously, as shown in the following screenshot.<br /> <img class="alignnone wp-image-4176 size-full" title="Screenshot of the groups created" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/06/RaviT-July2017-Screenshot2.jpg" alt="Screenshot of the groups created" width="864" height="590" /></li> 
</ol> 
<p>For this post’s example, I use these four policies:</p> 
<ol> 
<li><span style="font-family: courier">EXAMPLE-PSO-01</span> (highest priority policy) – For the administrators who manage Example Corp.’s password policies. Applying this highest priority policy to the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> group prevents these users from being locked out if they also are assigned to a different policy.</li> 
<li><span style="font-family: courier">EXAMPLE-PSO-02</span> (the second highest priority policy) – For Example Corp.’s other administrators.</li> 
<li><span style="font-family: courier">EXAMPLE-PSO-03</span> (the third highest priority policy) – For Example Corp.’s senior managers.</li> 
<li><span style="font-family: courier">EXAMPLE-PSO-05</span> (the lowest priority policy) – For Example Corp.’s general employees.</li> 
</ol> 
<p>This leaves me one password policy (<span style="font-family: courier">EXAMPLE-PSO-04</span>) that I can use for in the future if needed.</p> 
<p>I start by editing the policy, <span style="font-family: courier">EXAMPLE-PSO-01</span>. To edit the policy, I follow the <a href="https://aws.amazon.com/blogs/security/how-to-configure-strong-password-policies-to-help-meet-your-security-standards-by-using-aws-directory-service-for-microsoft-active-directory/#edit">Edit password policies</a> section from earlier in this post. When finished, I add the <span style="font-family: courier">Fine-Grained Pwd Policy Admins</span> group to that policy, as shown in the following screenshot. I then repeat the process for each of the remaining policies, as described in the <a href="https://aws.amazon.com/blogs/security/how-to-configure-strong-password-policies-to-help-meet-your-security-standards-by-using-aws-directory-service-for-microsoft-active-directory/#scenariooverview">Scenario overview</a> section earlier in this post.</p> 
<p><img class="alignnone wp-image-4226 size-full" title="Screenshot of adding the Fine-Grained Pwd Policy Admins group to the EXAMPLE-PSO-01 policy" src="https://d2908q01vomqb2.cloudfront.net/22d200f8670dbdb3e253a90eee5098477c95c23d/2017/07/10/RaviT-July2017-screenshot7-a.png" alt="Screenshot of adding the Fine-Grained Pwd Policy Admins group to the EXAMPLE-PSO-01 policy" width="900" height="455" /></p> 
<p>Though AD enforces new password policies, the timing related to how password policies replicate in the directory, the types of attributes that are changed, and the timing of user password changes can cause variability in the immediacy of policy enforcement. In general, after the policies are replicated throughout the directory, attributes that affect account lockout and password age take effect. Attributes that affect the quality of a password, such as password length, take effect when the password is changed. If the password age for a user is in compliance, but their password strength is out of compliance, the user is not forced to change their password. For more information password policy impact, see this <a href="https://technet.microsoft.com/en-us/library/hh994562(v=ws.10).aspx" target="_blank" rel="noopener noreferrer">Microsoft TechNet article</a>.</p> 
<h3>Summary</h3> 
<p>In this post, I have demonstrated how you can configure strong password policies to meet your security standards by using AWS Microsoft AD. To learn more about AWS Microsoft AD, see the <a href="http://aws.amazon.com/directoryservice/" target="_blank" rel="noopener noreferrer">AWS Directory Service home page</a>.</p> 
<p>If you have comments about this post, submit them in the “Comments” section below. If you have questions about this blog post, start a new thread on the&nbsp;<a href="https://forums.aws.amazon.com/forum.jspa?forumID=180" target="_blank" rel="noopener noreferrer">Directory Service forum.</a></p> 
<p>– Ravi</p> 
<footer> 
TAGS: 
<span property="keywords"><a href="https://aws.amazon.com/blogs/security/tag/active-directory/" rel="tag">Active Directory</a>, <a href="https://aws.amazon.com/blogs/security/tag/adac/" rel="tag">ADAC</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-directory-service/" rel="tag">AWS Directory Service</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-management-console/" rel="tag">AWS Management Console</a>, <a href="https://aws.amazon.com/blogs/security/tag/aws-microsoft-ad/" rel="tag">AWS Microsoft AD</a>, <a href="https://aws.amazon.com/blogs/security/tag/fgpp/" rel="tag">FGPP</a>, <a href="https://aws.amazon.com/blogs/security/tag/fine-grained-password-policies/" rel="tag">fine-grained password policies</a>, <a href="https://aws.amazon.com/blogs/security/tag/microsoft-ad/" rel="tag">Microsoft AD</a></span> 
</footer> 
<script>
require(['blog'], function() {
AWS.Blog.commenting('#aws-comment-trigger-4157');
});
</script> 
</article> 
<p>
© 2017, Amazon Web Services, Inc. or its affiliates. All rights reserved.
</p>

    </div>
  </div>
</div>


    <div id="footer" class="navigation hidden-print">
      <div class="container">
        <div class="row">
          <div class="col-xs-12">
            <ul class="footer-links nav navbar-nav">
              <li><a href="../aws.html">AWS</a></li>
              <li><a href="../linux.html">Linux</a></li>
              <li><a href="../docker.html">Docker</a></li>
              <li><a href="../ibmpower.html">IBM Power</a></li>
              <li><a href="blogsataws1.html">Blogs@AWS (Kindle Friendly)</a></li>
            </ul>
            <ul class="footer-links nav navbar-nav navbar-right">
              <li><a href="../comments.html">Comments?</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
